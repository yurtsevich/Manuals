<!doctype html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="be-tarask" class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Даведнік па Rails</title>
  <meta name="description" content="Даведнік па Rails">
  <meta name="author" content="Юрцэвіч Дзьмітры">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <!-- CSS : implied media="all" -->
  <link rel="stylesheet" href="../css/boilerplate.css?v=2">
  <link rel="stylesheet" href="../css/screen.css?v=1">
  <link rel="stylesheet" href="../css/rails.css?v=1">
  <link rel="stylesheet" href="../css/shCore.css?v=1">
  <link rel="stylesheet" href="../css/shThemeDefault.css?v=1">

  <!-- Uncomment if you are specifically targeting less enabled mobile browsers
  <link rel="stylesheet" media="handheld" href="css/handheld.css?v=2">  -->

  <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
  <script src="../js/libs/modernizr-1.6.min.js"></script>

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<body>

  <div id="container">
    <div id="index">
      <div id="main_index">
        <ul>
          <li><a href="../htmlRef/index.html">HTML</a></li>
          <li><a href="../cssRef/index.html">CSS</a></li>
          <li><a href="../jsRef/index.html">JS</a></li>
          <li><a href="../webRef/index.html">Web</a></li>
        </ul>
        <ul>
          <li><a href="../javaRef/index.html">Java</a></li>
        </ul>
        <ul>
          <li><a href="../rubyRef/index.html">Ruby</a></li>
          <li class="active"><a href="../railsRef/index.html">Rails</a></li>
        </ul>
        <ul>
          <li><a href="../gitRef/index.html">Git</a></li>
        </ul>
        <div class="zip_link"><a href="../Manuals.zip" title="Архіў усіх даведнікаў адным файлам (~9 Mb)"></a></div>
        <div class="github_link"><a href="https://github.com/yurtsevich/Manuals" title="Зыходнікі ўсіх даведнікаў на GitHub"></a></div>
      </div>

      <div id="content">
        <ul class="tree">

          <li><a href="#Links">Карысныя спасылкі</a>
            <ul>
              <li><a href="#Links_Home">Хатняя старонка</a></li>
              <li><a href="#Links_API">API</a></li>
              <li><a href="#Links_Refs">Даведнікі і кнігі</a></li>
              <li><a href="#Links_Casts">Railscast</a></li>
              <li><a href="#Links_Blogs">Блогі</a></li>
              <li><a href="#Links_UpgradeTo32">Апгрэйд да вэрсіі 3.2</a></li>
            </ul>
          </li>

          <li class="liOpen"><a href="#GettingStarted">Пачынаем</a>
            <ul>
              <li class="liOpen"><a href="#GettingStarted_WhatIsRails">Што такое Rails?</a>
                <ul>
                  <li><a href="#GettingStarted_WhatIsRails_MVC">Архітэктура MVC</a>
                    <ul>
                      <li><a href="#GettingStarted_WhatIsRails_MVC_Models">Мадэлі</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_MVC_Views">Вью</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_MVC_Controllers">Кантролеры</a></li>
                    </ul>
                  </li>
                  <li><a href="#GettingStarted_WhatIsRails_REST">REST</a></li>
                  <li><a href="#GettingStarted_WhatIsRails_Components">Кампанэнты Rails</a>
                    <ul>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActionPack">Action Pack</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActionController">Action Controller</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActionView">Action View</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActionDispatch">Action Dispatch</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActionMailer">Action Mailer</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActiveModel">Active Model</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActiveRecord">Active Record</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActiveResource">Active Resource</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_ActiveSupport">Active Support</a></li>
                      <li><a href="#GettingStarted_WhatIsRails_Components_Railties">Railties</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li><a href="#GettingStarted_NewProject">Стварэньне новага праекту</a>
                <ul>
                  <li><a href="#GettingStarted_NewProject_InstallingRails">Усталяваньне Rails</a></li>
                  <li><a href="#GettingStarted_NewProject_BlogProject">Стварэньне блогу</a></li>
                  <li><a href="#GettingStarted_NewProject_InstallingGems">Усталяваньне патрэбных гемаў</a></li>
                  <li><a href="#GettingStarted_NewProject_ConfiguringDB">Наладжваньне базы даных</a></li>
                  <li><a href="#GettingStarted_NewProject_CreatingDB">Стварэньне базы даных</a></li>
                  <li><a href="#GettingStarted_NewProject_StartingApp">Запуск праграмы</a></li>
                </ul>
              </li>
              <li><a href="#GettingStarted_Git">Кантроль вэрсій з Git</a></li>
              <li><a href="#GettingStarted_Deploying">Разгортваньне праграмы ў вытворчым асяродку</a></li>
              <li><a href="#GettingStarted_FastDevelopment">Хуткая распрацоўка</a></li>
            </ul>
          </li>

          <li class="liOpen"><a href="#Models">Мадэлі</a>
            <ul>
              <li class="liOpen"><a href="#Models_Migrations">Міграцыі</a>
                <ul>
                  <li><a href="#Models_Migrations_Creating">Стварэньне</a></li>
                  <li><a href="#Models_Migrations_Writing">Састаўленьне</a>
                    <ul>
                      <li><a href="#Models_Migrations_Writing_CreatingTable">Стварэньне табліцаў</a></li>
                      <li><a href="#Models_Migrations_Writing_ChangingTable">Зьмена табліцаў</a></li>
                      <li><a href="#Models_Migrations_Writing_Helpers">Дапаможнікі</a></li>
                      <li><a href="#Models_Migrations_Writing_DownMethod">Мэтад down</a></li>
                    </ul>
                  </li>
                  <li><a href="#Models_Migrations_Running">Выкананьне</a>
                    <ul>
                      <li><a href="#Models_Migrations_Running_Rollback">Адкат</a></li>
                      <li><a href="#Models_Migrations_Running_Reset">Reset</a></li>
                      <li><a href="#Models_Migrations_Running_Verbose">Вывад інфармацыі а хадзе міграцыі</a></li>
                    </ul>
                  </li>
                  <li><a href="#Models_Migrations_UsingModels">Выкарыстаньне мадэляў</a></li>
                  <li><a href="#Models_Migrations_Dumps">Адбіткі схемаў</a></li>
                </ul>
              </li>
              <li><a href="#Models_RakeCommands">Rake-каманды</a></li>
              <li><a href="#Models_NewRecords">Новыя экзэмпляры</a></li>
              <li><a href="#Models_TrackingChanges">Сачэньне за зьменамі</a></li>
              <li><a href="#Models_Validations">Валідацыя даных</a>
                <ul>
                  <li><a href="#Models_Validations_WhenHappen">Калі адбываецца валідацыя?</a></li>
                  <li><a href="#Models_Validations_Checking">valid? і invalid?</a></li>
                  <li><a href="#Models_Validations_Builtin">Убудаваныя валідатары</a>
                    <ul>
                      <li><a href="#Models_Validations_Builtin_acceptance">validates_acceptance_of</a></li>
                      <li><a href="#Models_Validations_Builtin_confirmation">validates_confirmation_of</a></li>
                      <li><a href="#Models_Validations_Builtin_exclusion">validates_exclusion_of</a></li>
                      <li><a href="#Models_Validations_Builtin_format">validates_format_of</a></li>
                      <li><a href="#Models_Validations_Builtin_inclusion">validates_inclusion_of</a></li>
                      <li><a href="#Models_Validations_Builtin_length">validates_length_of</a></li>
                      <li><a href="#Models_Validations_Builtin_numericality">validates_numericality_of</a></li>
                      <li><a href="#Models_Validations_Builtin_presence">validates_presence_of</a></li>
                      <li><a href="#Models_Validations_Builtin_uniqueness">validates_uniqueness_of</a></li>
                    </ul>
                  </li>
                  <li><a href="#Models_Validations_Custom">Уласныя валідатары</a>
                    <ul>
                      <li><a href="#Models_Validations_Custom_Attributes">Валідацыя атрыбутаў</a></li>
                      <li><a href="#Models_Validations_Custom_Instances">Валідацыя экзэмпляраў</a></li>
                      <li><a href="#Models_Validations_Custom_Methods">Мэтады-валідатары</a></li>
                    </ul>
                  </li>
                  <li><a href="#Models_Validations_Conditional">Умоўная валідацыя</a></li>
                  <li><a href="#Models_Validations_ErrorMessages">Паведамленьні аб памылках валідацыі</a></li>
                </ul>
              </li>
              <li><a href="#Models_Callbacks">Зваротныя выклікі</a>
                <ul>
                  <li><a href="#Models_Callbacks_Types">Тыпы зваротных выклікаў</a>
                    <ul>
                      <li><a href="#Models_Callbacks_Types_CreatingObject">Стварэньне аб'екту</a></li>
                      <li><a href="#Models_Callbacks_Types_UpdatingObject">Абнаўленьне аб'екту</a></li>
                      <li><a href="#Models_Callbacks_Types_DestroyingObject">Выдаленьне аб'екту</a></li>
                      <li><a href="#Models_Callbacks_Types_InitializingObject">after_initialize і after_find</a></li>
                    </ul>
                  </li>
                  <li><a href="#Models_Callbacks_RunningCallbacks">Калі выконваюцца зваротныя выклікі</a></li>
                  <li><a href="#Models_Callbacks_HaltingExecution">Адкат транзакцыі</a></li>
                  <li><a href="#Models_Callbacks_Conditional">Умоўныя выклікі</a></li>
                </ul>
              </li>
              <li><a href="#Models_Associations">Асацыяцыі</a></li>
              <li><a href="#Models_Querying">Састаўленьне запытаў</a></li>
            </ul>
          </li>

          <li class="liOpen"><a href="#Views">Вью</a>
            <ul>
              <li><a href="#Views_LayoutsRendering">Макеты і візуалізацыя ў Rails</a></li>
              <li><a href="#Views_FormHelpers">Дапаможнікі формаў</a></li>
            </ul>
          </li>

          <li class="liOpen"><a href="#Controllers">Кантролеры</a>
            <ul>
              <li><a href="#Controllers_Routing">Разводка</a></li>
              <li><a href="#Controllers_Parameters">Парамэтры</a>
                <ul>
                  <li><a href="#Controllers_Parameters_HashesAndArrays">Хэшы і масівы ў якасьці парамэтраў</a></li>
                  <li><a href="#Controllers_Parameters_Routing">Парамэтры разводкі</a></li>
                  <li><a href="#Controllers_Parameters_Default">Змоўчныя</a></li>
                </ul>
              </li>
              <li><a href="#Controllers_Cookies">Cookies</a></li>
            </ul>
          </li>

          <li class="liOpen"><a href="#Security">Бясьпека</a>
            <ul>
              <li><a href="#Security_Sessions">Сэсіі</a>
                <ul>
                  <li><a href="#Security_Sessions_Settings">Наладжваньне</a></li>
                  <li><a href="#Security_Sessions_TurnOff">Ігнараваньне</a></li>
                  <li><a href="#Security_Sessions_Flashes">Бліскаўкі</a>
                    <ul>
                      <li><a href="#Security_Sessions_Flashes_Now"><code class="method">flash.now</code></a></li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li><a href="#Security_Authentication">Ідэнтыфікацыя карыстальніка</a>

              </li>
              <li><a href="#Security_Authorization">Аўтарызацыя</a>

              </li>
              <li><a href="#Security_RequestForgery">Падробка запытаў</a>
                <ul>
                  <li><a href="#Security_RequestForgery_Protection">Абарона</a></li>
                </ul>
              </li>
              <li><a href="#Security_SSL">Бясьпечная перадача даных</a>
                <ul>
                  <li><a href="#Security_SSL_ConfiguringWEBrick">Наладка SSL для WEBrick</a>
                    <ul>
                      <li><a href="#Security_SSL_ConfiguringWEBrick_Certificate">Генерацыя сэртыфікату</a></li>
                      <li><a href="#Security_SSL_ConfiguringWEBrick_ActivatingSSL">Актывацыя SSL у WEBrick</a></li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </li>

          <li class="liOpen"><a href="#Mailer">Пошта</a>
          </li>

          <li class="liOpen"><a href="#WebServices">Вэб-сэрвісы</a>
          </li>

          <li class="liOpen"><a href="#RSS">RSS</a>
          </li>

          <li class="liOpen"><a href="#Optimization">Аптымізацыя</a>
            <ul>
              <li><a href="#Optimization_Scalability">Маштабіруемасьць</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <article id="main">
      <header>
        Даведнік па Rails
      </header>

      <p><a href="http://noteslog.com/post/netbeans-6-9-1-ruby-1-9-2-rails-3-0-0-debugging/">Rails debug in NetBeans</a></p>
      <p><a href="http://net.tutsplus.com/articles/web-roundups/essential-ruby-rails-3-reading-3/">Essential Ruby &amp; Rails 3 Reading</a></p>
      <p><a href="http://net.tutsplus.com/tutorials/ruby/ruby-for-newbies-testing-with-rspec/">Testing with Rspec</a></p>
      <p><a href="http://www.codyfauser.com/2008/7/4/rails-http-status-code-to-symbol-mapping">Rails HTTP status code to symbol mapping</a></p>
      <p><a href="http://www.buildingwebapps.com/transcript/79330-rails-form-processing">Rails forms processing</a></p>
      <p><a href="http://ryandaigle.com/articles/2009/8/6/what-s-new-in-edge-rails-cleaner-restful-controllers-w-respond_with">respond_with in Rails3</a></p>
      <p><a href="https://github.com/josevalim/inherited_resources">inherited_resources plugin/gem</a></p>
      <p><a href="http://everydayrails.com/2010/08/11/ruby-date-time-parsing-chronic.html">Parsing dates and times in Ruby and Rails with Chronic gem</a></p>
      <p><a href="http://spreecommerce.com/">Spree&nbsp;&mdash; E-Commerce Platform on RoR</a></p>
      <p><a href="http://net.tutsplus.com/articles/web-roundups/24-extremely-useful-ruby-gems-for-web-development/">24 Extremely Useful Ruby Gems for Web Development</a></p>
      <p><a href="http://blog.55minutes.com/2012/01/getting-compass-to-work-with-rails-31-and-32/">Getting Compass to Work With Rails 3.1 (and 3.2)</a></p>

      <section>
        <h1><a name="CMS">CMS</a></h1>
        <p><a href="http://refinerycms.com/">Refinery</a></p>
        <p><a href="http://www.locomotivecms.com/">Locomotive</a></p>
        <p><a href="http://webiva.org/">Webiva</a></p>
        <p><a href="http://radiantcms.org/">Radiant</a></p>
        <p><a href="http://www.caseincms.com/">Casein</a></p>
        <p><a href="http://www.browsercms.org/">BrowserCMS</a></p>

      </section>

      <aside class="warn">Гэты даведнік апісвае Rails 3.0. Некаторыя асаблівасьці, прыведзеныя тут, могуць не адпавядаць ранейшым вэрсіям Rails (а прыклады могуць не працаваць). Акрамя гэтага, для 3й вэрсіі Rails неабходна, каб быў усталяваны <a href="../rubyRef/index.html">Ruby</a> вэрсіі не ніжэй за 1.9.2. Будзьце ўважлівы!</aside>
      <section>
        <h1><a name="Links" href="#Links">Карысныя спасылкі</a></h1>
        <h2><a name="Links_Home" href="#Links_Home">Хатняя старонка</a></h2>
        <p><a href="http://rubyonrails.org/">http://rubyonrails.org</a></p>

        <aside>У якасьці IDE рэкамэндуецца карыстацца <a href="http://aptana.com/products/studio3/">Aptana Studio</a> (больш комплексная падтрымка Rails асяродку, але пакуль бэта і напрыклад кантэкстная дапамога працуе кепска) альбо <a href="http://netbeans.org/downloads/index.html">NetBeans</a> (на дадзены момант мусіць найлепшая падтрымка сярод бясплатных сродкаў).</aside>
        <h2><a name="Links_API" href="#Links_API">API</a></h2>
        <p>Ruby + Rails (вельмі добра рэалізаваны пошук): <a href="http://railsapi.com/doc/rails-v3.0.8rc1_ruby-v1.9.2/">http://railsapi.com/doc/rails-v3.0.8rc1_ruby-v1.9.2/</a></p>
        <p><a href="http://api.rubyonrails.org/">http://api.rubyonrails.org</a></p>
        <p><a href="http://www.rubydoc.info/docs/rails/3.0.0/frames/">http://www.rubydoc.info/docs/rails/3.0.0/frames</a></p>
        <p><a href="http://apidock.com/rails/">http://apidock.com/rails</a></p>

        <h2><a name="Links_Refs" href="#Links_Refs">Даведнікі і кнігі</a></h2>
        <p><a href="http://guides.rubyonrails.org/">Галоўная старонка афіцыйных даведнікаў</a></p>
        <p><a href="http://railsapps.github.com/rails.html">RailsApps project</a></p>
        <p><a href="http://railstutorial.org/book/">Вельмі добры вучэбнік</a></p>

        <p>http://www.bigfatrails.com/book/</p>

        <h2><a name="Links_Casts" href="#Links_Casts">Railscast (відэа-урокі)</a></h2>
        <p><a href="http://railscasts.com/">http://railscasts.com</a></p>

        <h2><a name="Links_Blogs" href="#Links_Blogs">Блогі</a></h2>
        <p>Апошнія Ruby і Rails навіны на <b>envylabs.com</b>: <a href="http://ruby5.envylabs.com/">http://ruby5.envylabs.com/</a></p>

        <h2><a name="Links_UpgradeTo32" href="#Links_UpgradeTo32">Апгрэйд да вэрсіі 3.2</a></h2>
        <p><a href="http://railsapps.github.com/installing-rails.html">http://railsapps.github.com/installing-rails.html</a></p>
        <p><a href="http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html">http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html</a></p>
      </section>

      <section>
        <h1><a name="GettingStarted" href="#GettingStarted">Пачынаем</a></h1>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/getting_started.html">Guide</a></li>
          </ul>
        </div>

        <h2><a name="GettingStarted_WhatIsRails" href="#GettingStarted_WhatIsRails">Што такое Rails?</a></h2>
        <p>Rails&nbsp;&mdash; гэта фрэймворк распрацоўкі сеціўных праграмаў, напісаны на мове праграмаваньня <a href="../rubyRef/index.html">Ruby</a>. Ён спраектаваны такім чынам, каб зрабіць працэс стварэньня сеціўных праграмаў прасьцейшым, улічваючы тыя аспэкты, зь якімі вымушаны сутыкацца бальшыня распрацоўшчыкаў. Rails дазваляе пісаць менш коду, рашаючы пры тым больш задачаў, чым іншыя мовы ці фрэймворкі.</p>
        <p>Дадзены фрэймворк грунтуецца на дапушчэньні, што ў шэрагу магчымых рашэньняў заўсёды існуюць найлепшыя, і ён &laquo;заахвочвае&raquo; распрацоўшчыка да карыстаньня імі, і часам нават робіць &laquo;перашкоды&raquo; на шляху карыстаньня ня лепшымі з рашэньняў.</p>
        <p>Філязофія Rails уключае такія прынцыпы, як:
          <ul>
            <li>DRY (ад анг. <i>Don't Repeat Youself</i>, што азначае <i>не паўтарайце сябе</i>)&nbsp;&mdash; сьцвярджае, што пісаць шматкроць адзін і той жа код зьяўляецца кепскай рэччу.</li>
            <li>Дамоўленасьці па-над наладкамі&nbsp;&mdash; азначае, што ў Rails у шмат якіх выпадках ужо прадвызначана што і як трэба рабіць, замест таго, каб патрабаваць ад распрацоўшчыка вызначаць кожную дробязь праз файлы канфігурацыі.</li>
            <li><a href="#GettingStarted_WhatIsRails_REST">REST</a> зьяўляецца найлепшым шаблёнам (<i>pattern</i>) для сеціўных праграмаў&nbsp;&mdash; арганізацыя праграмаў вакол рэсурсаў і стандартных <abbr class="term" title="HyperText Transfer Protocol">HTTP</abbr> дзеясловаў прыводзіць да найхутчэйшага іх стварэньня.</li>
          </ul>
        </p>

        <h3><a name="GettingStarted_WhatIsRails_MVC" href="#GettingStarted_WhatIsRails_MVC">Архітэктура MVC</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/rails.html#mvc-request-lifecycle">Rails 3 in a Nutshell</a></li>
          </ul>
        </div>
        <figure style="float: right;">
          <img alt="Архітэктура MVC у дзеі" title="Архітэктура MVC у дзеі" src="../images/mvc.png"/>
          <figcaption class="imgcaption">Архітэктура MVC у дзеі: жыцьцёвы шлях Rails-запыту</figcaption>
        </figure>
        <p>У ядры Rails ляжыць <a href="http://en.wikipedia.org/wiki/Model–view–controller">архітэктурны патэрн Мадэль-Вью-Кантролер</a> (ад анг. <i>Model-View-Controller</i>, ці скарочана MVC), перавагамі якога зьяўляюцца:
          <ul>
            <li>ізаляцыя бізнэс-лёгікі ад інтэрфэйсу;</li>
            <li>лёгкасьць утрымліваць код DRY;</li>
            <li>ясна дзе знаходзіцца код таго ці іншага тыпу, што палягчае будучую падтрымку коду.</li>
          </ul>
        </p>
        <p>У адпаведнасьці з гэтым патэрнам адбываецца наступная пасьлядоўнасьць працэдураў:</p>
        <ol>
          <li>браўзэр дасылае запыт да вэб-сэрверу, які перадасылае яго адпаведнаму Rails-кантролеру (файлы ў тэчцы <code>app/controllers/</code>);</li>
          <li>кантролер зьвяртаецца да адпаведнай мадэлі (файлы ў тэчцы <code>app/models/</code>), каб атрымаць даныя, неабходныя для адказу на атрыманы запыт;</li>
          <li>мадэль адказная за тое, каб сфармаваць належны запыт да базы даных, каб атрымаць адтуль неабходныя даныя;</li>
          <li>база вяртае даныя;</li>
          <li>мадэль правярае валіднасьць даных і вяртае іх кантролеру;</li>
          <li>кантролер перадае даныя ў шаблён вью (<i>view templates</i>&nbsp;&mdash; файлы ў тэчцы <code>app/views/</code>, якія ў агульным выпадку ўяўляюць зь сябе <a href="../htmlRef/index.html">HTML</a>-файлы з убудаваным <a href="../rubyRef/index.html">Ruby</a>-кодам);</li>
          <li>шаблён вью фармуе <a href="../htmlRef/index.html">HTML</a>-старонку (ізноў такі ў агульным выпадку, хаця гэта можа быць напрыклад кавалак <a href="../jsRef/index.html">JavaScript</a>-коду) і перадае яе ў кантролер;</li>
          <li>кантролер дасылае вынік браўзэру.</li>
        </ol>

        <h4><a name="GettingStarted_WhatIsRails_MVC_Models" href="#GettingStarted_WhatIsRails_MVC_Models">Мадэлі</a></h4>
        <p>Мадэль утрымлівае бізнэс-лёгіку і прадстаўляе даныя праграмы. Для прыняцьця рашэньняў мадэль зьвяртаецца да базы даных. Яна адказвае за атрыманьне, стварэньне, зьмяненьне, выдаленьне даных з БД, а таксама сочыць за цэласнасьцю гэтых даных. У выпадку Rails асноўнае выкарыстаньне мадэляў&nbsp;&mdash; кіраваньне правіламі атрыманьня інфармацыі з БД. У бальшыні выпадкаў адна мадэль праграмы будзе адпавядаць адной табліцы базы даных.</p>
        <p>Больш дэталёва пра мадэлі глядзі <a href="#Models">ніжэй</a>.</p>

        <h4><a name="GettingStarted_WhatIsRails_MVC_Views" href="#GettingStarted_WhatIsRails_MVC_Views">Вью</a></h4>
        <p>Вью прадстаўляюць інтэрфэйс праграмы.</p>

        <h4><a name="GettingStarted_WhatIsRails_MVC_Controllers" href="#GettingStarted_WhatIsRails_MVC_Controllers">Кантролеры</a></h4>
        <p>Кантролеры зьяўляюцца &laquo;клеям&raquo; паміж мадэлямі і вью. У Rails яны адказваюць за апрацоўку запытаў ад браўзэраў, атрыманьне ў адпаведнасьці з тымі запытамі даных з мадэляў, і перадачу гэтых даных у вью для прадстаўленьня карыстальніку.</p>

        <h3><a name="GettingStarted_WhatIsRails_REST" href="#GettingStarted_WhatIsRails_REST">REST</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://www.petefreitag.com/item/431.cfm">REST vs SOAP</a></li>
            <li><a href="http://www.xfront.com/REST-Web-Services.html">xfront.com</a></li>
            <li><a href="http://www.infoq.com/articles/rest-introduction/">Brief Intro</a></li>
            <li><a href="http://bitworking.org/news/373/An-Introduction-to-REST/">Intro</a></li>
            <li><a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">Wiki</a></li>
            <li><a href="http://ajaxpatterns.org/RESTful_Service">ajaxpatterns.org</a></li>
            <li><a href="http://www.infoq.com/articles/webber-rest-workflow">REST workflow</a></li>
          </ul>
        </div>
        <p>REST зьяўляецца абрэвіятураў ад ангельскага <i>REpresentational State Transfer</i> (перадача прадстаўнічага стану) і зьяўляецца асновай RESTful архітэктуры. Лічыцца, што ўпершыню гэты архітэктурны прынцып быў сфармуляваны ў <a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">доктарскай дысэртацыі Роя Філдзінга</a>. Ён (прынцып) вызначае сеціўную праграму як набор рэсурсаў, доступ да якіх ажыцьцяўляецца праз аднастайныя, прадказуемыя <abbr class="term" title="Uniform Resource Locator">URL</abbr>&#39;ы і <abbr class="term" title="HyperText Transfer Protocol">HTTP</abbr>-дзеясловы <code>GET</code>, <code>PUT</code>, <code>POST</code> і <code>DELETE</code>. Гэтыя URL&#39;ы (HTTP-дзеясловы) вяртаюць пэўнае прадстаўленьне рэсурсу і пераводзяць кліента (браўзэр) у пэўны стан.</p>
        <p>Напр., запыт кшталту:</p>
        <p><code>DELETE /photos/17</code></p>
        <p>будзе зразумелы ў Rails як зьвяртаньне да фота-рэсурсу з ідэнтыфікатарам 17 і пазначэньне пры гэтым пажаданай апэрацыі&nbsp;&mdash; выдаленьне гэтага рэсурсу.</p>
        <p>REST зьяўляецца натуральным стылем для архітэктуры сеціўных праграмаў і Rails рэалізуе яго ў сваім нутры даволі празрыста і пазбаўляе распрацоўшчыка ад неабходнасьці паглыбляцца ў складаныя аспэкты RESTful-архітэктуры.</p>

        <h3><a name="GettingStarted_WhatIsRails_Components" href="#GettingStarted_WhatIsRails_Components">Кампанэнты Rails</a></h3>
        <p>Rails уключае ў сябе шэраг асобных кампанэнтаў:
          <ul>
            <li>Action Pack
              <ul>
                <li>Action Controller</li>
                <li>Action View</li>
                <li>Action Dispatch</li>
              </ul>
            </li>
            <li>Action Mailer</li>
            <li>Active Model</li>
            <li>Active Record</li>
            <li>Active Resource</li>
            <li>Active Support</li>
            <li>Railties</li>
          </ul>
        </p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActionPack" href="#GettingStarted_WhatIsRails_Components_ActionPack">Action Pack</a></h4>
        <p>Гэта <a href="../rubyRef/index.html#Gems">гем</a>, каторы ўтрымлівае <a href="#GettingStarted_WhatIsRails_Components_ActionController"><cite>Action Controller</cite></a>, <a href="#GettingStarted_WhatIsRails_Components_ActionView"><cite>Action View</cite></a> і <a href="#GettingStarted_WhatIsRails_Components_ActionDispatch"><cite>Action Dispatch</cite></a>&nbsp;&mdash; &laquo;VC&raquo; частку з &laquo;<a href="#GettingStarted_WhatIsRails_MVC">MVC</a>&raquo;.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActionController" href="#GettingStarted_WhatIsRails_Components_ActionController">Action Controller</a></h4>
        <p>Гэта кампанэнт, які кіруе <a href="#GettingStarted_WhatIsRails_MVC_Controllers">кантролерамі</a>. Апрацоўвае запыты да Rails-праграмы, вымае зь іх парамэтры і накіроўвае запыты да адпаведных дзеяў (<i>actions</i>&nbsp;&mdash; пад такім агульным паняцьцем разумеюцца мэтады кантролераў). Таксама прадстаўляе такія сэрвісы, як кіраваньне сэсіямі і перанакіраваньнямі, візуалізацыя шаблёнаў.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActionView" href="#GettingStarted_WhatIsRails_Components_ActionView">Action View</a></h4>
        <p>Кіруе <a href="#GettingStarted_what_is_MVC_Views">вью</a> праграмы. Па-змоўчаньні можа ствараць <a href="../htmlRef/index.html">HTML</a>- і <abbr class="term" title="eXtensible Markup Language">XML</abbr>-вынік. Кіруе шіблёнамі вью, улучна з укладзенымі шаблёнамі (<mark><i>nested templates</i>-спасылка на разьдзел</mark>) і часткамі-шаблёнамі (<mark><i>partial templates</i>-спасылка на разьдзел</mark>), а таксама ўключае ў сябе ўбудаваную падтрымку <a href="http://en.wikipedia.org/wiki/AJAX">AJAX</a>.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActionDispatch" href="#GettingStarted_WhatIsRails_Components_ActionDispatch">Action Dispatch</a></h4>
        <p>Адказвае за разводку вэб-запытаў і накаріваньне іх па жаданьню распрацоўшчыка.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActionMailer" href="#GettingStarted_WhatIsRails_Components_ActionMailer">Action Mailer</a></h4>
        <p>Фрэймворк для пабудовы паштовага сэрвісу. Адказвае за атрыманьне, апрацоўку ўваходных лістоў, а таксама за адсылку простых ці складаных лістоў на базе гнуткіх шаблёнаў.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActiveModel" href="#GettingStarted_WhatIsRails_Components_ActiveModel">Active Model</a></h4>
        <p>Забяспечвае інтрэрфэйс паміж сэрвісамі <a href="#GettingStarted_WhatIsRails_Components_ActionPack"><cite>Action Pack</cite></a> і <a href="http://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a>-гемамі, як напр. <a href="#GettingStarted_WhatIsRails_Components_ActiveRecord"><cite>Active Record</cite></a>.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActiveRecord" href="#GettingStarted_WhatIsRails_Components_ActiveRecord">Active Record</a></h4>
        <p>Зьяўляецца базай для пабудовы <a href="#GettingStarted_WhatIsRails_MVC_Models">мадэляў</a>. Забяспечвае незалежнасьць ад пэўнай рэалізацыі базы даных, базавую <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>-функцыянальнасьць, пашыраныя магчымасьці пошуку, магчымасьці злучаць мадэлі паміж сабой і іншыя.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActiveResource" href="#GettingStarted_WhatIsRails_Components_ActiveResource">Active Resource</a></h4>
        <p>Прадстаўляе фрэймворк сувязі паміж бізнэс-аб&#8217;ектамі і RESTful вэб-сэрвісамі праз <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>-сэмантыку.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_ActiveSupport" href="#GettingStarted_WhatIsRails_Components_ActiveSupport">Active Support</a></h4>
        <p>Пашыраная бібліятэка дапаможных клясаў Ruby, каторыя выкарыстоўваюцца як ядром Rails, так і праграмай.</p>

        <h4><a name="GettingStarted_WhatIsRails_Components_Railties" href="#GettingStarted_WhatIsRails_Components_Railties">Railties</a></h4>
        <p>Ядро Rails, каторае спалучае разам розныя фрэймворкі і ўбудовы.</p>

        <h2><a name="GettingStarted_NewProject">Стварэньне новага праекту</a></h2>

        <h3><a name="GettingStarted_NewProject_InstallingRails">Усталяваньне Rails</a></h3>
        <p>Перад тым, як ствараць Rails-праект, трэба ўсталяваць уласна Rails:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ gem install rails
        ]]></script>

        <h3><a name="GettingStarted_NewProject_BlogProject">Стварэньне блогу</a></h3>
        <p>Пасьля ўсталяваньня Rails можна ствараць новую праграму, напрыклад блог, папярэдне перайшоўшы ў тэчку, прызначаную для Rails-праектаў:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ mkdir projects
        $ cd projects
        $ rails new blog
        ]]></script>
        <p>Апошняя каманда створыць шкілет Rails-праекту пад назвай <i>Blog</i> у тэчцы <code>blog</code>. Гэты шкілет уяўляе зь сябе пэўную структуру файлаў і тэчак, аднолькавую для ўсіх Rails-праектаў, што зьяўляецца вялікім плюсам Rails&nbsp;&mdash; унівэрсальная структура файлаў і тэчак усіх Rails-праектаў значна палягчае іх падтрымку нават тымі распрацоўшчыкамі, каторыя першапачаткова ня ўдзельнічалі ў іх распрацоўцы. Разгледзем падрабязьней гэтую структуру:
          <table>
            <caption>Структура шкілету Rails-праграмы</caption>
            <thead>
              <tr><th>Файл/Тэчка</th> <th>Прызначэньне</th></tr>
            </thead>
            <tbody>
              <tr><td class="file_folder"><code>app/</code></td> <td>Уласна код, уключаючы мадэлі, вью, кантролеры і хэлперы.</td></tr>
              <tr><td class="file_folder"><code>config/</code></td> <td>Наладкі: маршруты (<i>routes</i>), база даных, інтэрнацыяналізацыя і інш.</td></tr>
              <tr><td class="file_folder"><code>db/</code></td> <td>Файлы маніпуляцыяў базай даных. Утрымлівае цяперашнюю схему, файлы міграцыі даных і першапачатковай ініцыялізацыі базы.</td></tr>
              <tr><td class="file_folder"><code>doc/</code></td> <td>Дакумэнтацыя.</td></tr>
              <tr><td class="file_folder"><code>lib/</code></td> <td>Модулі бібліятэк.</td></tr>
              <tr><td class="file_folder"><code>log/</code></td> <td>Логі.</td></tr>
              <tr><td class="file_folder"><code>public/</code></td> <td>Адзіная тэчка, каторая бачна &laquo;звонку&raquo;. У ёй утрымліваюцца выявы, <a href="../cssRef/index.html">CSS</a>-файлы, <a href="../jsRef/index.html">JavaScript</a>'ы і іншыя статычныя файлы.</td></tr>
              <tr><td class="file_folder"><code>script/</code></td> <td>Скрыпты для старту і разгортваньня праграмы, для старту вэб-сэрверу і інш.</td></tr>
              <tr><td class="file_folder"><code>test/</code></td> <td>Тэсты (юніт-тэсты, <i>fixtures</i> і інш.).</td></tr>
              <tr><td class="file_folder"><code>tmp/</code></td> <td>Часовыя файлы.</td></tr>
              <tr><td class="file_folder"><code>vendor/</code></td> <td>Староньні код, звычайна <a href="../rubyRef/index.html#Gems">гемы</a>.</td></tr>
              <tr><td class="file_folder"><code>README</code></td> <td>Апісаньне і даведнік па праграме. Павінен утрымліваць інфармацыю як усталёўваць і карыстацца праграмай.</td></tr>
              <tr><td class="file_folder"><code>Rakefile</code></td> <td>Файл утрымлівае batch-каманды, каторыя могуць быць запушчаныя пры дапамозе праграмы <code>rake</code> у тэрмінальным акне. Аналяг <code>build.xml</code> пры выкарыстаньні <a href="http://ant.apache.org/"><code>ant</code></a>.</td></tr>
              <tr><td class="file_folder"><code>Gemfile</code></td> <td>Апісаньне гемаў, каторыя патрабуюцца праграме.</td></tr>
              <tr><td class="file_folder"><code>config.ru</code></td> <td>Наладкі для Rack-сэрвероў, каторыя выкарыстоўваюцца для старта праграмы.</td></tr>
            </tbody>
          </table>
        </p>

        <h3><a name="GettingStarted_NewProject_InstallingGems">Усталяваньне патрэбных гемаў</a></h3>
        <p>Rails-праграмы па змоўчаньні кіруюць <a href="../rubyRef/index.html#Gems">гемамі</a> і іх залежнасьцямі праз <a href="http://gembundler.com/">Bundler</a>. Як нам ня трэба ніякіх гемаў больш за тыя, што пазначаныя ў змоўчаным <code>Gemfile</code>, можна проста запусьціць наступную каманду, каб усталяваць іх:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ bundle install
        ]]></script>

        <h3><a name="GettingStarted_NewProject_ConfiguringDB">Наладжваньне базы даных</a></h3>
        <p>Мала якія Rails-праграмы могуць абысьціся без базы даных. Аднак, перад тым, як Active Record зможа быць выкарыстаны і праявіць сваё ORM-чараўніцтва, трэба яму сказаць зь якой базай даных будзе весьціся праца і якім чынам зь ёй наладзіць сувязь. Адпаведныя наладкі пазначаюцца ў файле канфігурацыі <code>config/database.yml</code>, які пасьля генэрацыі новай праграмы выглядае наступным чынам:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          # SQLite version 3.x
          #   gem install sqlite3-ruby (not necessary on OS X Leopard)
          development:
            adapter: sqlite3
            database: db/development.sqlite3
            pool: 5
            timeout: 5000

          # Warning: The database defined as "test" will be erased and
          # re-generated from your development database when you run "rake".
          # Do not set this db to the same as development or production.
          test:
            adapter: sqlite3
            database: db/test.sqlite3
            pool: 5
            timeout: 5000

          production:
            adapter: sqlite3
            database: db/production.sqlite3
            pool: 5
            timeout: 5000
        ]]></script>
        <aside><sup>1</sup> Той факт, што кожны з асяродкаў выкарыстоўвае свой асобны экзэмпляр базы даных, можа прыводзіць да спакусы выкарыстоўваць для кожнага зь іх свой тып, а адпаведна і адаптар, базы даных. Напрыклад, SQLite для асяродку распрацоўкі, і PostgreSQL для вытворчага асяродку. Недахопам такога падыходу зьяўляецца тое, што адрозьненьні паміж рознымі базамі даных могуць быць схаваныя пакуль вы распрацоўваеце праграму і выявіцца праз нечаканыя і непрыемныя сюрпрызы ў часе запуску праграмы ў вытворчым асяродку. Таму добрай практыкай можна лічыць імкненьне трымаць канфігурацыю розных асяродкаў як мага бліжэй адна да другой.</aside>
        <p>Гэты файл утрымлівае сэкцыі для канфігурацыі 3-х розных асяродкаў, у якіх Rails можа запускацца па змоўчваньні<sup>1</sup>:</p>
        <ul>
          <li>асяродак <strong>распрацоўкі</strong> (<i>development</i>) выкарыстоўваецца непасрэдна пры распрацоўцы праграмы;</li>
          <li><strong>тэставы</strong> (<i>test</i>) асяродак выкарыстоўваецца пры запуску аўтаматычных тэстаў;</li>
          <li><strong>вытворчы</strong>/<strong>працоўны</strong> (<i>production</i>) асяродак выкарыстоўваецца пасьля разгортваньня праграмы на агульнадаступных сэрвэрах для мэтавага выкарыстаньня.</li>
        </ul>

        <p>Rails пастаўляецца з убудаванай падтрымкай <a href="http://www.sqlite.org/">SQLite</a>, якая зьяўляецца &laquo;лёгкай&raquo; базай даных, не патрабуючай для сваёй працы сэрвэраў (так званая <i>file-based</i>). Яна не патрабуе дадатковых крокаў па сваёй наладцы і запуску, і таму па-змоўчаньні (прыклад вышэй) усе асяродкі будуць наладжаны выкарыстоўваць менавіта яе.</p>
        <p>Акрамя SQLite у Rails убудаваная выключная падтрымка яшчэ <a name="GettingStarted_NewProject_ConfiguringDB_MySQL">MySQL</a> і <a href="http://www.postgresql.org/">PostgreSQL</a>, а таксама маецца шэраг дадаткаў для падтрымкі іншых базаў даных.</p>

        <p>Пры жаданьні, ствараючы новую Rails-праграму, можна пазначыць, каб файл наладкаў быў створаны са змоўчнымі парамэтрамі да іншага тыпу базы даных. Для гэтага трэба скарыстацца опцыяй <code>--database</code>:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
          $ rails new myapp --database=mysql
        ]]></script>
        <p>Прыклады наладкаў да іншых тыпаў базаў даных:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          development:
            adapter: mysql2
            encoding: utf8
            reconnect: false
            database: test-mysql2_development
            pool: 5
            username: some_user_name
            password: some_password
            socket: /tmp/mysql.sock

          # Warning: The database defined as "test" will be erased and
          # re-generated from your development database when you run "rake".
          # Do not set this db to the same as development or production.
          test:
            adapter: sqlite3
            database: db/test.sqlite3
            pool: 5
            timeout: 5000

          production:
            adapter: postgresql
            host: some_hosting.amazonaws.com
            port: 5432
            username: some_user_name
            password: some_password
            database: some_db_name
            encoding: utf8
        ]]></script>

        <h3><a name="GettingStarted_NewProject_CreatingDB">Стварэньне базы даных</a></h3>
        <p>Базы даных адрозныя ад <a href="http://www.sqlite.org/">SQLite</a> часьцей за ўсё ствараюцца ўручную адміністратарам/праграмістам, але трэба памятаць, што Rails прадстаўляе мэханізм для аўтаматычнага стварэньня базы даных&nbsp;&ndash; пры дапамозе наступнай каманды:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
          rake db:create
        ]]></script>
        <p>Гэтая каманда створыць базу даных у адпаведным асяродку, узяўшы даныя з файла <code>config/database.yml</code>. Калі ёсьць патрэба сварыць адначасова базы даных для ўсіх асяродкаў, можна скарыстацца варыяцыяй гэтай каманды:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
          rake db:create:all
        ]]></script>

        <h3><a name="GettingStarted_NewProject_StartingApp">Запуск праграмы</a></h3>
        <p>Засталося запусьціць вэб-сэрвер, каб пабачыць стартавую старонку аўтаматычна створанай па-змоўчаньні праграмы:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
          $ rails server
        ]]></script>
        <p>Каб пабачыць вынік, трэба ў адрасным радку вэб-браўзэра набраць <a href="http://localhost:3000">http://localhost:3000</a>. Вы павінны пабачыць наступную старонку:</p>
        <img alt="Start page of Rails default application" title="Start page of Rails default application" src="../images/StartPageOfRoRDefaultApp.png"/>
        <p>Гэта ўсяго толькі статычная старонка, прызначэньнем якой зьяўляецца паказаць, што падрыхтоўчыя крокі зроблены правільна і пасьпяхова. Калі вас не цікавяць пытаньні <a href="#GettingStarted_Git">кантролю вэрсій</a> і <a href="#GettingStarted_Deploying">разгортваньня праграмы ў вытворчым асяродку</a>, можаце адразу перайсьці да разьделу <a href="#GettingStarted_FastDevelopment">хуткай распрацоўкі праграмы</a>.</p>

        <h2><a name="GettingStarted_Git">Кантроль вэрсій з Git</a></h2>
        <p><strong>TODO</strong>: <a href="http://ruby.railstutorial.org/chapters/beginning#sec:version_control">http://ruby.railstutorial.org/chapters/beginning#sec:version_control</a></p>

        <h2><a name="GettingStarted_Deploying">Разгортваньне праграмы ў вытворчым асяродку</a></h2>
        <p><strong>TODO</strong>: <a href="http://ruby.railstutorial.org/chapters/modeling-and-viewing-users-two#sec:heroku_deploy">http://ruby.railstutorial.org/chapters/modeling-and-viewing-users-two#sec:heroku_deploy</a></p>

        <h3><a name="GettingStarted_Deploying_HerokuMultipleAccounts">Праца зь некалькімі рахункамі на <i>Heroku</i></a></h3>
        <p>Гэта не трывіяльная задача, таму што па змоўчаньні гем ад <i>Heroku</i> працуе з адзіным рахункам. Але гэтая задача моцна спрашчаецца пры выкарыстаньні дадатку <a href="https://github.com/ddollar/heroku-accounts" title="Хатняя старонка heroku-accounts на GitHub"><code>heroku-accounts</code></a>.</p>
        <p>Дадатак удзяляе літаральна некалькі простых у выкарыстаньні дапаможных камандаў, якія вычарпальна апісаныя на хатняй старонцы дадатку, таму ня буду яшчэ раз спыняцца на апісаньні. Адзінае, што варта адмыслова адзначыць, у код дадатку варта ўнесьці адну зьмену пры жаданьні ўжываць яго ў <i>Windows</i>-асяродку. Гэтая зьмена будзе працаваць толькі пачынаючы з <i>Rails</i> 3-й вэрсіі, але наш даведнік разглядае менавіта гэтую вэрсію, таму скарыстаемся ёй. Праблема тычыцца хатняй тэчкі карыстальніка ў <i>Windows</i>, пэўныя каманды дадатку не працуюць з-за таго, што ў ім выкарыстоўваецца ўласны спосаб вызначэньня гэтай тэчкі, відаць не зусім правільны. Такім чынам, зьмену трэба ўнесьці ў файл <code>&lt;USER_HOME&gt;\.heroku\plugins\heroku-accounts\lib\ext\heroku\command\accounts.rb</code>, у мэтадзе <code class="method">accounts_directory</code> выраз:</p>
        <script type="syntaxhighlighter" class="brush: rails"><![CDATA[
          directory = File.join(home_directory, ".heroku", "accounts")
        ]]></script>
        <p>трэба зьмяніць наступным чынам:</p>
        <script type="syntaxhighlighter" class="brush: rails"><![CDATA[
          directory = File.join(Dir.home, ".heroku", "accounts")
        ]]></script>

        <h2><a name="GettingStarted_FastDevelopment">Хуткая распрацоўка</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://ruby.railstutorial.org/chapters/a-demo-app#top">Book</a></li>
            <li><a href="http://guides.rubyonrails.org/getting_started.html#creating-a-resource">Guide</a></li>
          </ul>
        </div>
        <p><a href="#GettingStarted_NewProject_BlogProject">Вышэй</a> мы разглядалі працэс стварэньня новага праекту, у выніку чаго атрымалі ўнівэрсальны змоўчны каркас праграмы і статычную старонку, каторая адчыняецца па карнявым адрасе. Каб пабачыць нашу праграму ў дынаміцы (напрыклад, адлюстраваць на старонцы тэкст &laquo;Вітаю, сусьвет!&raquo;), неабходна перш за ўсё выдаліць статычную старонку <code>public/index.html</code>. У Rails існуе шэраг каманд і прыладаў, каторыя паскараюць працэс стварэньня як асобных кампанэнтаў (кантролер, мадэль), гэтак і поўную сукупнасьць усіх неабходных кампанэнтаў для паўнавартаснай працы з пэўным рэсурсам праграмы. Напрыклад, наступным чынам можна стварыць мінімалістычныя кантролер і вью:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rails generate controller home index
        ]]></script>
        <p>Па гэтай камандзе Rails створыць за вас некалькі файлаў, у тым ліку <code>app/views/home/index.html.erb</code>. Гэта шаблён, каторы будзе выкарыстоўвацца для адлюстраваньня вынікаў дзеі <code>index</code> <code>home</code>-кантролеру. Адкрыем гэты шаблён і ўвядзем туды наступны тэкст:</p>
        <script type="syntaxhighlighter" class="brush: html"><![CDATA[
        <h1>Hello, Rails!</h1>
        ]]></script>
        <aside><sup>1</sup> Падрабязную інфармацыю пра разводку глядзіце ў разьдзеле <a href="#Controllers_Routing">Разводка</a>.</aside>
        <p>Наступным крокам трэба сказаць Rails&#8217;у, якая дзея якога кантролера павінна быць выкананай па карнявым адрасе. Адчынім файл <code>config/routes.rb</code>&nbsp;&mdash; гэта файл так званай разводкі<sup>1</sup> (ці маршрутызацыі), які ўтрымлівае запісы на адмысловай <i>domain-specific</i> мове, якія вызначаюць да якога кантролеру і якой зь ягоных дзеяў напраўляць уваходныя запыты. Зробім там наступны запіс:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        Blog::Application.routes.draw do

          root :to => "home#index"
        ]]></script>

        <h3><a name="GettingStarted_FastDevelopment_Scaffolding">Scaffolding</a></h3>
        <p>Акрамя генерацыі асобных кампанэнтаў, прыладай <i>scaffold</i> можна згенерыць поўную сукупнасьць неабходных кампанэнтаў для працы з пэўным рэсурсам. Уявім, што ў нашай праграме павінен існаваць рэсурс допісаў у блогу (<i>Post</i>), экзэмпляры якога карыстальнік можа ствараць, рэдагаваць і выдаляць. Напрыклад, наступная каманда:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rails generate scaffold Post name:string title:string content:text
        ]]></script>
        <p>Створыць 14 файлаў, неабходныя дадатковыя тэчкі і ўнясе зьмены ў адзін файл:
          <table>
            <!--caption>Структура шкілету Rails-праграмы</caption-->
            <thead>
              <tr><th>Файл</th> <th>Прызначэньне</th></tr>
            </thead>
            <tbody>
              <tr><td><code>db/migrate/20100207214725_create_posts.rb</code></td> <td><a href="#Models_Migrations">Міграцыя</a> для стварэньня табліцы ў базе для захаваньня допісаў (у імені вашага файлу будзе іншая часаадзнака).</td></tr>
              <tr><td><code>app/models/post.rb</code></td> <td>Мадэль допісаў.</td></tr>
              <tr><td><code>test/fixtures/posts.yml</code></td> <td>Штучныя допісы для тэставых мэтаў.</td></tr>
              <tr><td><code>app/controllers/posts_controller.rb</code></td> <td>Кантролер допісаў.</td></tr>
              <tr><td><code>app/views/posts/index.html.erb</code></td> <td>Вью (ці шаблён), які будзе адлюстроўваць сьпіс усіх захаваных допісаў.</td></tr>
              <tr><td><code>app/views/posts/edit.html.erb</code></td> <td>Вью, у якой будуць рэдагавацца допісы.</td></tr>
              <tr><td><code>app/views/posts/show.html.erb</code></td> <td>Вью для адлюстраваньня пэўнага допісу.</td></tr>
              <tr><td><code>app/views/posts/new.html.erb</code></td> <td>Вью для стварэньня новага допісу.</td></tr>
              <tr><td><code>app/views/posts/_form.html.erb</code></td> <td><i>Partial</i>, каторы адказвае за візуалізацыю формы рэдагаваньня і стварэньня допісаў.</td></tr>
              <tr><td><code>app/helpers/posts_helper.rb</code></td> <td>Дапаможныя мэтады апрацоўкі допісаў.</td></tr>
              <tr><td><code>test/unit/post_test.rb</code></td> <td><i>Unit</i>-тэсты мадэлі.</td></tr>
              <tr><td><code>test/functional/posts_controller_test.rb</code></td> <td>Функцыянальныя тэсты кантролеру.</td></tr>
              <tr><td><code>test/unit/helpers/posts_helper_test.rb</code></td> <td><i>Unit</i>-тэсты дапаможных мэтадаў.</td></tr>
              <tr><td><code>config/routes.rb</code></td> <td>Гэты файл будзе адрэдагаваны, каб уключыць апдаведную разводку запытаў.</td></tr>
              <tr><td><code>public/stylesheets/scaffold.css</code></td> <td><a href="../cssRef/index.html">CSS</a>-стылі <i>scaffold</i>-прылады.</td></tr>
            </tbody>
          </table>
        </p>
        <p>Пасьля гэтага трэба запусьціць міграцыю, каб яна стварыла неабходную табліцу ў базе:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rake db:migrate
        ]]></script>
        <p>А таксама дадаць спасылку да допісаў з нашай галоўнай старонкі (<code>app/views/home/index.html.erb</code>):</p>
        <script type="syntaxhighlighter" class="brush: html"><![CDATA[
        <h1>Hello, Rails!</h1> <%= link_to "My Blog", posts_path %>
        ]]></script>
        <p>Дапаможны мэтад <code>link_to</code>, які даступны да ўсіх вью, створыць спасылку з тэксту і шляху (<code>posts_path</code>), каторыя былі яму перададзены.</p>
        <p>Цяпер, калі адкрыць галоўную старонку (<a href="http://localhost:3000">http://localhost:3000</a>) і націснуць на спасылку &laquo;My Blog&raquo;, мы пабачым наступную старонку:</p>
        <img alt="Posts index" title="Posts index" src="../images/posts_index.png"/>
        <p>Гэта змоўчнае адлюстраваньне допісаў. У базе яшчэ няма ніводнага, але калі націснуць на &laquo;New post&raquo;, можна стварыць першы. Пасьля стварэньня допісу, вы пабачыце, што яго можна праглядаць, рэдагаваць і выдаляць, і ўсё гэта было створана аўтаматычна прыладай <i>scaffold</i>.</p>

        <h4><a name="GettingStarted_FastDevelopment_Scaffolding_Model">Мадэль</a></h4>
        <p>Створаная пры дапамозе <i>scaffold</i> мадэль (<code>app/models/post.rb</code>) пустая:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class Post < ActiveRecord::Base
        end
        ]]></script>
        <p>аднак базавую сваю функцыянальнасьць (стварэньне, выдаленьне, рэдагаваньне допісаў, запыты да базы) яна ўспадкоўвае ад <code class="class">ActiveRecord::Base</code>. Можам дадаць у яе пэўную праверку даных, каторыя карыстальнік будзе ўводзіць у форму:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class Post < ActiveRecord::Base
          validates :name,  :presence => true
          validates :title, :presence => true,
                            :length => { :minimum => 5 }
        end
        ]]></script>
        <p>Гэты код будзе правяраць ці мае допіс імя і загаловак, каторы пры гэтым павінен утрымліваць мінімум 5 сымбаляў, перад тым, як гэты допіс захаваць у базу.</p>

        <h4><a name="GettingStarted_FastDevelopment_Scaffolding_ListingResources">Адлюстраваньне рэсурсаў</a></h4>
        <p>Код, каторы <i>scaffold</i> уставіў у мэтад <code class="method">index</code> кантролеру <code>app/controllers/posts_controller.rb</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        def index
          @posts = Post.all

          respond_to do |format|
            format.html # index.html.erb
            format.xml  { render :xml => @posts }
          end
        end
        ]]></script>
        <aside><sup>2</sup> Падрабязную інфармацыю пра запыты да базы глядзіце ў разьдзеле <a href="#Models_Querying">Састаўленьне запытаў</a>.</aside>
        <p>адказвае за адлюстраваньне ўсіх допісаў. Выклік <code>Post.all</code> запытаецца ў мадэлі па ўсе допісы, каторыя захаваныя ў базе<sup>2</sup>. У выніку будзе вернуты масіў допісаў, які захаваецца ў зьменнай экзэмпляру <code class="var">@posts</code>.</p>
        <p>Блёк <code>respond_to</code> апрацоўвае як <a href="../htmlRef/index.html">HTML</a>-, так і <abbr class="term" title="eXtensible Markup Language">XML</abbr>-запыты да гэтай дзеі. Калі ў адрасным радку будзе ўведзена <code>http://localhost:3000/posts.xml</code>, у выніку будуць адлюстраваны ўсе допісы ў <abbr class="term" title="eXtensible Markup Language">XML</abbr>-фармаце. Для стварэньня <a href="../htmlRef/index.html">HTML</a>-водгуку будзе ўзята вью з <code>app/views/posts/</code>, імя якой адпавядае назьве дзеі (<code>app/views/posts/index.html.erb</code>):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <h1>Listing posts</h1>

        <table>
          <tr>
            <th>Name</th>
            <th>Title</th>
            <th>Content</th>
            <th></th>
            <th></th>
            <th></th>
          </tr>

        <% @posts.each do |post| %>
          <tr>
            <td><%= post.name %></td>
            <td><%= post.title %></td>
            <td><%= post.content %></td>
            <td><%= link_to 'Show', post %></td>
            <td><%= link_to 'Edit', edit_post_path(post) %></td>
            <td><%= link_to 'Destroy', post,
                :confirm => 'Are you sure?', :method => :delete %></td>
          </tr>
        <% end %>
        </table>

        <br />

        <%= link_to 'New post', new_post_path %>
        ]]></script>
        <p>Тут вью пасьлядоўна праходзіцца па ўсім элемэнтам масіву <code class="var">@posts</code>, каб адлюстраваць іх даныя і адпаведныя спасылкі. <code class="method">edit_post_path</code> і <code class="method">new_post_path</code>&nbsp;&mdash; дапаможныя мэтады атрыманьня адпаведнага <i>RESTful</i>-шляху.</p>

      </section>


      <section>
        <h1><a name="Models" href="#Models">Мадэлі</a></h1>
        <p>Змоўчны спосаб захаваньня даных у Rails&nbsp;&mdash; праз базу даных і змоўчным кампанэнтам для гэтых мэтаў зьяўляецца <a href="http://railsapi.com/doc/rails-v3.0.8rc1/files/activerecord/README_rdoc.html">Active Record</a> (рэалізацыя <a href="http://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a> у Rails). Ён прадстаўляе шмат мэтадаў для стварэньня, захаваньня і пошуку аб&#8217;ектаў даных і ўсё гэта без неабходнасьці выкарыстоўваць (а адпаведна і ведаць) <abbr title="Structured Query Language">SQL</abbr>. Больш таго, пры дапамозе <a href="#Models_Migrations">міграцыяў</a>, апісаньне данных можна рабіць на чыстым Ruby, без неабходнасьці ведаць SQL <i>Data Definition Language (DDL)</i>. У выніку распрацоўшчык у Rails у агульным выпадку можа абстрагавацца ад асаблівасьцяў і дэталяў сродкаў захаваньня даных, якія будуць ужывацца. То бок у распрацоўшчыцкім асяродку можа выкарыстоўвацца <a href="http://www.sqlite.org/">SQLite</a>, у тэставым асяродку&nbsp;&mdash; <a href="http://mysql.com/">MySQL</a>, а ў вытворчым&nbsp;&mdash; <a href="http://www.postgresql.org/">PostgreSQL</a>, і на самой праграме гэта ніяк не адаб&#8217;ецца.</p>
        <p>Яшчэ адзін кампанэнт, які прадстаўляе мадэлі ў Rails&nbsp;&mdash; гэта <a href="http://railsapi.com/doc/rails-v3.0.8rc1/files/activeresource/README_rdoc.html">Active Resource</a>. Падрабязьней пра яго глядзі разьдзел <a href="file:///D:/_Buisiness/Manuals/railsRef/index.html#WebServices">Вэб-сэрвісы</a>.</p>

        <h2><a name="Models_Migrations" href="#Models_Migrations">Міграцыі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/migrations.html">Guide</a></li>
          </ul>
        </div>
        <p>Стварэньне і зьмены ў структуры даных у Rails робіцца пры дапамозе міграцыяў:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class CreateProducts < ActiveRecord::Migration
          def self.up
            create_table :products do |t|
              t.string :name
              t.text :description

              t.timestamps
            end
          end

          def self.down
            drop_table :products
          end
        end
        ]]></script>
        <p>Запуск пазначанай вышэй міграцыі (падкляса <code>ActiveRecord::Migration</code>) праз выкананьне мэтаду <code>up</code> прывядзе да таго, што будзе створана табліца <code>products</code> з радковай калёнкай <code>name</code> і тэкставай калёнкай <code>description</code>. Акрамя гэтага па змоўчаньні будзе створана калёнка першаснага ключу <code>id</code>, нават без яўнага пазначэньня. Таксама будуць створаны калёнкі часаадзнакі <code>created_at</code> і <code>updated_at</code>, зьмест каторых <a href="http://railsapi.com/doc/rails-v3.0.8rc1/files/activerecord/README_rdoc.html">Active Record</a> будзе зьмяняць аўтаматычна. Створаныя міграцыяй зьмены могуць быць адкочаны праз выклік мэтаду <code>down</code> (у дадзеным выпадку табліца <code>products</code> будзе выдалена).</p>
        <p>Таксама міграцыямі можна зьмяняць ня толькі структуру, але і самі даныя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class AddReceiveNewsletterToUsers < ActiveRecord::Migration
          def self.up
            change_table :users do |t|
              t.boolean :receive_newsletter, :default => false
            end
            User.update_all ["receive_newsletter = ?", true]
          end

          def self.down
            remove_column :users, :receive_newsletter
          end
        end
        ]]></script>
        <p>У прыкладзе вышэй да табліцы <code>users</code> будзе дададзена калёнка <code>receive_newsletter</code>, якая па змоўчаньні будзе запаўняцца значэньнямі <code>false</code>, але ў існых запісах табліцы гэтая калёнка будзе запоўнена значэньнем <code>true</code>. У гэтым прыкладзе ёсьць адзін падводны камень&nbsp;&mdash; выкарыстаньне клясы мадэлі, чаму гэтага рабіць не пажадана глядзіце разьдзел <a href="#Models_Migrations_UsingModels">&laquo;Выкарыстаньне мадэляў у міграцыях&raquo;</a></p>
        <p>Для базаў даных, каторыя падтрымліваюць транзакцыі (<a href="http://www.postgresql.org/">PostgreSQL</a>, <a href="http://www.sqlite.org/">SQLite</a>), міграцыі будуць абгорнуты ў транзакцыю. Калі ж база не падтрымлівае транзакцыі (<a href="http://mysql.com/">MySQL</a>), тады ў выпадку памылкі зьмены, каторыя адбыліся да памылкі, ня будуць адменены аўтаматычна і іх адкат трэба будзе рабіць &laquo;рукамі&raquo;.</p>
        <p>Міграцыі захоўваюцца ў тэчцы <code>db/migrate</code> і маюць выгляд фармату "<code>YYYYMMDDHHMMSS_імя_клясы_міграцыі.rb</code>", дзе "<code>YYYYMMDDHHMMSS</code>"&nbsp;&mdash; дата і час міграцыі, пасьля якой праз знак падкрэсьліваньня ідзе імя міграцыі, каторае павінна супадаць зь імем адпаведнай клясы. Напрыклад, файл міграцыі <code>20080906120000_create_products.rb</code> павінен утрымліваць клясу міграцыі <code>CreateProducts</code>. Дата і час у назьве файла неабходны Rails&#8217;у для ідэнтыфікацыі міграцыі. Гэты ідэнтыфікатар нараўне з адзнакамі якія міграцыі ўжо былі выкананыя дазваляе правільна апрацоўваць складаныя сытуацыі пры распрацоўцы праграмы некалькімі распрацоўшчыкамі. Хаця апошняе, натуральна, не пазбаўляе чальцоў каманды ад неабходнасьці ўзгадняць свае дзеяньні.</p>
        <p>Пры патрэбе зьмяніць міграцыю, каторая ўжо была выканана, не магчыма проста ўнесьці ў яе зьмены і выканаць ізноў&nbsp;&mdash; Rails у адпаведнасьці з запісамі ў сваім журнале пабачыць, што такая міграцыя ўжо выконвалася і нічога ня зробіць у выпадку запуску каманды <code>rake db:migrate</code>. Трэба спачатку адмяніць міграцыю (<code>rake db:rollback</code>), унесьці неабходныя зьмены і потым ізноў выканаць яе.</p>
        <p>Пры гэтым памятайце, што калі зьявілася неабходнасьць зьмяніць ужо існую міграцыю&nbsp;&mdash; ці то праз памылку, ці то праз новыя акалічнасьці, дазваляецца рабіць гэта толькі ў выпадках, калі яна ўяўляе зь сябе лякальную вэрсію&nbsp;&mdash; не запісана яшчэ ў сыстэму кантролю вэрсій для каманднага карыстаньня, ці, што асабліва важна, не была шчэ ўжыта ў вытворчым асяродку. Калі ж міграцыя ўсё ж была ўжыта, лепш стварыць новую міграцыю, у якую прапісаць неабходныя зьмены.</p>

        <h3><a name="Models_Migrations_Creating" href="#Models_Migrations_Creating">Стварэньне міграцыяў</a></h3>
        <p>Пры стварэньні мадэляў ці пры карыстаньні <i>scaffold</i>-генератарамі міграцыі будуць створаны аўтаматычна. Напрыклад, у выніку выкананьня каманды:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rails generate model Product name:string description:text
        ]]></script>
        <p>будзе створана міграцыя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class CreateProducts < ActiveRecord::Migration
          def self.up
            create_table :products do |t|
              t.string :name
              t.text :description

              t.timestamps
            end
          end

          def self.down
            drop_table :products
          end
        end
        ]]></script>
        <p><code>t.timestamps</code> будзе дададзена нават, калі гэта не пазначыць у камандзе стварэньня мадэлі.</p>
        <p>Калі ж трэба стварыць міграцыю для ўжо існай мадэлі (табліцы ў базе) тады можна скарыстацца генератарам міграцыі:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rails generate migration AddPartNumberToProducts
        ]]></script>
        <p>У выніку выкананьня папярэдняй каманды будзе створана пустая міграцыя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class AddPartNumberToProducts < ActiveRecord::Migration
          def self.up
          end

          def self.down
          end
        end
        ]]></script>
        <p>Калі імя міграцыі адпавядае фарматам "<code>AddXXXToYYY</code>" ці "<code>RemoveXXXFromYYY</code>" і пасьля імені міграцыі ў камандзе ідзе сьпіс палёў зь іх тыпамі, тады ў міграцыю будуць устаўлены выклікі адпаведных мэтадаў: <code>add_column</code> ці <code>remove_column</code>. Напрыклад, пасьля выкананьня:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rails generate migration AddDetailsToProducts part_number:string price:decimal
        ]]></script>
        <p>будзе створана міграцыя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class AddDetailsToProducts < ActiveRecord::Migration
          def self.up
            add_column :products, :part_number, :string
            add_column :products, :price, :decimal
          end

          def self.down
            remove_column :products, :price
            remove_column :products, :part_number
          end
        end
        ]]></script>

        <h3><a name="Models_Migrations_Writing" href="#Models_Migrations_Writing">Састаўленьне міграцыяў</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html">Мэтады</a></li>
          </ul>
        </div>
        <p>Па спасылцы зьлева можна даведацца пра ўсе мэтады, каторыя даступны ў мэтадах <code>up</code> і <code>down</code> міграцыяў.</p>

        <h4><a name="Models_Migrations_Writing_CreatingTable" href="#Models_Migrations_Writing_CreatingTable">Стварэньне табліцаў</a></h4>
        <div class="refs">
          <ul>
            <li><a href="http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/TableDefinition.html">Мэтады</a></li>
          </ul>
        </div>
        <p>Табліцы можна ствараць пры дапамозе мэтаду <code>create_table</code> (па спасылцы зьлева можна даведацца пра ўсе мэтады, каторыя даступны аб&#8217;екту, які перадаецца ў блёк мэтаду <code>create_table</code>):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        create_table :products do |t|
          t.string :name
        end
        ]]></script>
        <p>Стварэньне калёнкі ў папярэднім прыкладзе запісана сучасным спосабам, існуе шчэ традыцыйны спосаб:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        create_table :products do |t|
          t.column :name, :string
        end
        ]]></script>
        <p>Па-змоўчаньні мэтад <code>create_table</code> створыць у новай табліцы першасны ключ <code>id</code>. Калі імя першаснага ключа трэба зьмяніць, трэба яўна ўставіць выраз стварэньня гэтага поля і пазначыць для яго опцыю <code>:primary_key</code>.</p>
        <p>Тыпы калёнак, каторыя падтрымліваюцца <a href="http://railsapi.com/doc/rails-v3.0.8rc1/files/activerecord/README_rdoc.html">Active Record</a> наступныя:</p>
        <table>
          <thead>
            <tr>
              <th width="33%">Тып Active Record</th>
              <th width="33%">Тып SQLite</th>
              <th>Кляса Ruby</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>:integer</code>, <code>:primary_key</code></td>
              <td>integer</td>
              <td><code>Fixnum</code></td>
            </tr>
            <tr>
              <td><code>:decimal</code></td>
              <td>decimal</td>
              <td><code>BigDecimal</code></td>
            </tr>
            <tr>
              <td><code>:float</code></td>
              <td>float</td>
              <td><code>Float</code></td>
            </tr>
            <tr>
              <td><code>:string</code></td>
              <td>varchar(255)</td>
              <td><code>String</code></td>
            </tr>
            <tr>
              <td><code>:text</code></td>
              <td>text</td>
              <td><code>String</code></td>
            </tr>
            <tr>
              <td><code>:binary</code></td>
              <td>blob</td>
              <td><code>String</code></td>
            </tr>
            <tr>
              <td><code>:date</code></td>
              <td>date</td>
              <td><code>Date</code></td>
            </tr>
            <tr>
              <td><code>:datetime</code>, <code>:timestamp</code></td>
              <td>datetime</td>
              <td><code>Time</code></td>
            </tr>
            <tr>
              <td><code>:time</code></td>
              <td>time</td>
              <td><code>Time</code></td>
            </tr>
            <tr>
              <td><code>:boolean</code></td>
              <td>boolean</td>
              <td><code>TrueClass</code>/<code>FalseClass</code></td>
            </tr>
          </tbody>
        </table>
        <p>Гэтыя тыпы будуць аўтаматычна пераўтварацца ў тыпы базы, каторая ўжываецца на цяперашні момант. Напрыклад, у выпадку <a href="http://mysql.com/">MySQL</a> тып <code>:string</code> будзе пераўтвораны ў <code>VARCHAR(255)</code>. Акрамя гэтага можна пазначаць тыпы, якія не падтрымліваюцца <a href="http://railsapi.com/doc/rails-v3.0.8rc1/files/activerecord/README_rdoc.html">Active Record</a> праз традыцыйны запіс стварэньня калёнак:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        create_table :products do |t|
          t.column :name, 'polygon', :null => false
        end
        ]]></script>

        <h4><a name="Models_Migrations_Writing_ChangingTable" href="#Models_Migrations_Writing_ChangingTable">Зьмена табліцаў</a></h4>
        <div class="refs">
          <ul>
            <li><a href="http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Table.html">Мэтады</a></li>
          </ul>
        </div>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        change_table :products do |t|
          t.remove :description, :name
          t.string :part_number
          t.index :part_number
          t.rename :upccode, :upc_code
        end
        ]]></script>
        <p>У папярэднім прыкладзе з табліцы <code>products</code> будуць выдаленыя калёнкі <code>description</code> і <code>name</code>, устаўлена калёнка <code>part_number</code>, да каторай будзе дададзен індэкс, а калёнка <code>upccode</code> будзе перайменавана ў <code>upc_code</code>. Тое ж сама ў традыцыйнай форме будзе:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        remove_column :products, :description
        remove_column :products, :name
        add_column :products, :part_number, :string
        add_index :products, :part_number
        rename_column :products, :upccode, :upc_code
        ]]></script>

        <h4><a name="Models_Migrations_Writing_Helpers" href="#Models_Migrations_Writing_Helpers">Дапаможнікі</a></h4>
        <p>Існуе шэраг мэтадаў-дапаможнікаў, якія спрашчаюць напісаньне міграцыяў. Напрыклад, згаданы вышэй <code>timestamps</code>, які дадае ў табліцу аб&#8217;яўленьні калёнак <code>created_at</code> і <code>updated_at</code>. Яшчэ адзін мэтад-дапаможнік&nbsp;&mdash; <code>references</code>, у якога існуе псэўданім <code>belongs_to</code>. Ён дадае апісаньне калёнкі, якая зьяўляецца зьнешнім ключом да іншай табліцы. Наступны прыклад:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        create_table :products do |t|
          t.references :category
        end
        ]]></script>
        <p>дадасьць калёнку <code>category_id</code> адпаведнага тыпу. Зьвярніце ўвагу, што ў мэтад перадаецца імя мадэлі (<code>category</code>), а не імя калёнкі (<code>category_id</code>), пры гэтым <code>_id</code> будзе дададзена аўтаматычна. Яшчэ вельмі істотная заўвага&nbsp;&mdash; у выпадку выкананьня гэтага мэтаду будзе проста дададзена калёнка адпаведнай назвы і тыпу, але ня будзе ўстаўлены неабходны <i>constraint</i> праверкі цэласнасьці ключоў. Зрабіць гэта трэба альбо праз выклік адпаведнага &laquo;сырога&raquo; SQL (глядзі ў <a href="#Models_Migrations_Writing_DownMethod">прыкладзе ніжэй</a>), альбо праз карыстаньне дадаткам <a href="http://rubydoc.info/gems/automatic_foreign_key/1.2.0/frames/"><i>Automatic Foreign Key</i></a>. Згаданы дадатак у самым простым выпадку лічыць, што калі ў вас ёсьць калёнка <code>customer_id</code>, вы жадаеце, каб быў створаны <i>foreign key constraint</i> на калёнку <code>id</code> табліцы <code>customers</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        create_table :orders do |t|
          t.column :customer_id, :integer, :null => false
          ...
        end
        ]]></script>

        <h4><a name="Models_Migrations_Writing_DownMethod" href="#Models_Migrations_Writing_DownMethod">Мэтад <code>down</code></a></h4>
        <p>Мэтад <code>down</code> міграцыі павінен адкаціць тое, што было зроблена мэтадам <code>up</code>. Іншымі словамі стан базы павінен застацца нязьменным у выніку пасьлядоўнага выкананьня мэтадаў <code>up</code> і <code>down</code>. Прычым апошні павінен рабіць адкат зьменаў у зваротным парадку ў параўнаньні з тым, які быў ў мэтадзе <code>up</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class ExampleMigration < ActiveRecord::Migration

          def self.up
            create_table :products do |t|
              t.references :category
            end
            #add a foreign key
            execute <<-SQL
              ALTER TABLE products
                ADD CONSTRAINT fk_products_categories
                FOREIGN KEY (category_id)
                REFERENCES categories(id)
            SQL

            add_column :users, :home_page_url, :string

            rename_column :users, :email, :email_address
          end

          def self.down
            rename_column :users, :email_address, :email
            remove_column :users, :home_page_url
            execute "ALTER TABLE products DROP FOREIGN KEY fk_products_categories"
            drop_table :products
          end
        end
        ]]></script>
        <p>Часам дзеяньні міграцыяў могуць быць незваротнымі&nbsp;&mdash; напрыклад, выдаленьне пэўных даных. У такім разе, мэтад <code>down</code> нічога не павінен рабіць, а толькі кідаць выключэньне <code>IrreversibleMigration</code>.</p>

        <h3><a name="Models_Migrations_Running" href="#Models_Migrations_Running">Выкананьне міграцыяў</a></h3>
        <p>Rake-каманда <code>db:migrate</code> запускае ўсе міграцыі, якія шчэ не былі выкананыя. Яна ў сваю чаргу запусьціць каманду <code>db:schema:dump</code>, якая зьменіць файл <code>db/schema.rb</code>, каб ён адпавядаў новай структуры базы. Для выкананьня ня проста ўсіх новых міграцыяў, але для пераходу да пэўнага стану, трэба пазначыць адпаведную вэрсію:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rake db:migrate VERSION=20080906120000
        ]]></script>
        <p>Вэрсія&nbsp;&mdash; гэта часаадзнакавы прэфікс перад імем міграцыі ў імені файла міграцыі. У выпадку, калі пазначаная вэрсія большая за цяперашнюю, будуць выкананыя мэтады <code>up</code> у тых міграцыяў, якія шчэ не былі выкананыя і чыя вэрсія меншая ці роўная пазначанай у камандзе. Калі ж мы пазначаем вэрсію меншую за цяперашнюю (то бок робім адкат), тады будзе выкананы мэтад <code>down</code> у тых міграцыяў, якія ўжо былі выкананыя і вэрсія якіх большая за пазначаную ў камандзе.</p>
        <p>Калі трэба выканаць/адкаціць ня проста <em>ўсе</em> міграцыі да пэўнай вэрсіі, але мэтад <code>up</code> ці <code>down</code> пэўнай адзінай міграцыі, тады трэба карыстацца камандамі <code>db:migrate:up</code> і <code>db:migrate:down</code>:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rake db:migrate:up VERSION=20080906120000
        ]]></script>
        <p>Прычым Rails сам правярае ці карэктная гэта каманда. То бок, калі пэўная міграцыя ўжо была выканана і мы спрабуем для яе запусьціць каманду <code>db:migrate:up</code>, ці, калі пэўная міграцыя яшчэ не была выканана і мы спрабуем для яе запусьціць каманду <code>db:migrate:down</code>, то ў абодвух выпадках нічога ня будзе зроблена.</p>

        <h4><a name="Models_Migrations_Running_Rollback" href="#Models_Migrations_Running_Rollback">Адкат</a></h4>
        <p>Для адкату апошняй(-іх) міграцыі(-яў) ёсьць дапаможны мэтад <code>rollback</code>. Наступная каманда зробіць адкат апошняй выкананай міграцыі:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rake db:rollback
        ]]></script>
        <p>Каб зрабіць адкат некалькіх апошніх міграцыяў дастаткова пазначыць іх колькасьць у парамэтры <code>STEP</code>. Наступная каманда зробіць адкат трох апошніх міграцыяў:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ rake db:rollback STEP=3
        ]]></script>

        <h4><a name="Models_Migrations_Running_Reset" href="#Models_Migrations_Running_Reset">Reset</a></h4>
        <p>І яшчэ адна дапаможная каманда: <code>db:reset</code>. Яна выдаліць базу, створыць яе зноўку і загрузіць туды актуальную <a href="#Models_Migrations_Dumps">схему</a> (але гэта ня тое ж самае, што пасьлядоўна выканаць усе міграцыі).</p>

        <h4><a name="Models_Migrations_Running_Verbose" href="#Models_Migrations_Running_Verbose">Вывад інфармацыі а хадзе міграцыі</a></h4>
        <p>Па змоўчаньні пры выкананьні міграцыі ў кансоль будзе вывадзіцца трасіровачная інфармацыя а хадзе міграцыі. Нешта кшталту:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        20080906170109 CreateProducts: migrating
        -- create_table(:products)
           -> 0.0021s
        -- add_index(:products, :name)
           -> 0.0026s
        20080906170109 CreateProducts: migrated (0.0059s)
        ]]></script>
        <p>Існуе шэраг мэтадаў, якія могуць уплываць на гэты працэс:
          <ul>
            <li><code>suppress_messages</code>&nbsp;&mdash; падаўляе вывад любой трасіровачнай інфармацыі ў сваім блёку;</li>
            <li><code>say</code>&nbsp;&mdash; выводзіць тэкст, які перадаецца ў якасьці парамэтру;</li>
            <li><code>say_with_time</code>&nbsp;&mdash; выводзіць тэкст, які перадаецца ў якасьці парамэтру, потым час, які выконваўся яго блёк, і ў выпадку, калі блёк вяртае цэлы лік, лічыць, што гэта колькасьць задзейнічаных міграцыяй радкоў.</li>
          </ul>
        </p>
        <p>Напрыклад, міграцыя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class CreateProducts < ActiveRecord::Migration
          def self.up
            suppress_messages do
              create_table :products do |t|
                t.string :name
                t.text :description
                t.timestamps
              end
            end
            say "Created a table"
            suppress_messages {add_index :products, :name}
            say "and an index!", true
            say_with_time 'Waiting for a while' do
              sleep 10
              250
            end
          end

          def self.down
            drop_table :products
          end
        end
        ]]></script>
        <p>прывядзе да наступнага вываду:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        20080906170109 CreateProducts: migrating
          Created a table
           -> and an index!
          Waiting for a while
           -> 10.0001s
           -> 250 rows
        20080906170109 CreateProducts: migrated (10.0097s)
        ]]></script>
        <p>Калі ж вы жадаеце, каб міграцыя ўвогуле не рабіла ніякага вываду, запускаць яе трэба з опцыяй <code>VERBOSE=false</code>.</p>

        <h3><a name="Models_Migrations_UsingModels" href="#Models_Migrations_UsingModels">Выкарыстаньне мадэляў у міграцыях</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/migrations.html#using-models-in-your-migrations">Чаму не?</a></li>
          </ul>
        </div>
        <p>Гэтага рабіць вельмі не пажадана! Чаму і якія існуюць рашэньні абыходу праблемы глядзі па спасылцы зьлева.</p>

        <h3><a name="Models_Migrations_Dumps" href="#Models_Migrations_Dumps">Адбіткі схемаў</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/migrations.html#schema-dumping-and-you">Dumps</a></li>
          </ul>
        </div>
        <p>Што такое <code>db/schema.rb</code> і як рабіць міграцыю цалкам усёй схемы глядзі па спасылцы зьлева.</p>

        <h2><a name="Models_RakeCommands" href="#Models_RakeCommands">Rake-каманды</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://www.tutorialspoint.com/ruby-on-rails/rails-and-rake.htm">Tutorialspoint.com</a></li>
          </ul>
        </div>
        <p>У табліцы ніжэй прыводзіцца сьпіс некаторых rake-камандаў, якія тычацца мадэляў, міграцыяў і базаў даных.</p>
        <table>
          <thead>
            <tr>
              <th width="200px">Каманда</th>
              <th>Апісаньне</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>rake db:create</code></td>
              <td>Створыць экзэмпляр базы даных у адпаведным асяродку.</td>
            </tr>
            <tr>
              <td><code>rake db:create:all</code></td>
              <td>Створыць экзэмпляры базы даных усіх асяродкаў.</td>
            </tr>
            <tr>
              <td><code>rake db:drop</code></td>
              <td>Выдаліць экзэмпляр базы даных у адпаведным асяродку.</td>
            </tr>
            <tr>
              <td><code>rake db:drop:all</code></td>
              <td>Выдаліць экзэмпляры базы даных усіх асяродкаў.</td>
            </tr>
            <tr>
              <td><code>rake db:reset</code></td>
              <td>Выдаліць экзэмпляр базы, створыць яго наноў і загрузіць у яго схему (зьмест файлу <code>db/schema.rb</code>)</td>
            </tr>
            <tr>
              <td><code>rake db:seed</code></td>
              <td>Загрузіць у базу пачатковыя даныя (зьмест файлу <code>db/seeds.rb</code>)</td>
            </tr>
            <tr>
              <td><code>rake db:setup</code></td>
              <td>Створыць экзэмпляр базы, загрузіць у яго схему (зьмест файлу <code>db/schema.rb</code>) і загрузіць пачатковыя даныя (зьмест файлу <code>db/seeds.rb</code>)</td>
            </tr>
            <tr>
              <td><code>rake db:version</code></td>
              <td>Выводзіць вэрсію актуальнай (апошняй выкананай) міграцыі.</td>
            </tr>
            <tr>
              <td><code>rake db:migrate:status</code></td>
              <td>Выводзіць табліцу ўсіх міграцыяў з пазначэньнем вэрсіі міграцыі і ці была яна ўжо выканана.</td>
            </tr>
            <tr>
              <td><code>rake db:migrate</code></td>
              <td>Выконвае міграцыі (запускае мэтады міграцыяў <code>up</code> ці <code>change</code>), якія шчэ не былі выкананыя. Камандзе можна перадаваць парамэтар <code>VERSION</code>. Калі значэньне гэтага парамэтру большае за вэрсію актуальнай міграцыі, тады будзе выкананы мэтад <code>up</code> усіх міграцыяў паміж цяперашняй і пазначанай у парамэтры ўключна. Калі ж значэньне парамэтру меншае за актуальную, тады будзе выкананы мэтад <code>down</code> усіх міграцыяў паміж цяперашняй і пазначанай у парамэтры ўключна:
              <script type="syntaxhighlighter" class="brush: text"><![CDATA[
                $ rake db:migrate VERSION=20080906120000
              ]]></script>
              </td>
            </tr>
            <tr>
              <td><code>rake db:rollback</code></td>
              <td>Адкочвае актуальную міграцыю (запускае мэтад міграцыі <code>down</code> ці робіць аўтаматычны, па пэўным альгарытме адкат мэтаду <code>change</code>). Калі ёсьць патрэба адкаціць адразу некалькі міграцыяў, можна перадаць камандзе парамэтар <code>STEP</code>, у якім пазначыць колькасьць апошніх выкананых міграцыяў, якія павінны быць адкочаны:
              <script type="syntaxhighlighter" class="brush: text"><![CDATA[
                $ rake db:rollback STEP=3
              ]]></script>
              </td>
            </tr>
            <tr>
              <td><code>rake db:migrate:redo</code></td>
              <td>Перавыконвае актуальную міграцыю (пасьлядоўна робіць адкат міграцыі і выконвае яе ізноў &nbsp;&ndash; гл. дзьве каманды вышэй у табліцы). Як і ў выпадку адкочваньня, можна перадаць камандзе парамэтар <code>STEP</code>, у якім пазначыць колькасьць апошніх міграцыяў, якія павінны быць перавыкананы:
              <script type="syntaxhighlighter" class="brush: text"><![CDATA[
                $ rake db:migrate:redo STEP=2
              ]]></script>
              </td>
            </tr>
            <tr>
              <td><code>rake db:fixtures:load</code></td>
              <td>Загрузіць тэставыя даныя (файлы <code>.yml</code> у тэчцы <code>test/fixtures</code>) у базу бягучага асяродку. Калі ёсьць патрэба загрузіць ня ўсе, але толькі пэўныя даныя, можна скарыстацца парамэтрам <code>FIXTURES</code>:
              <script type="syntaxhighlighter" class="brush: text"><![CDATA[
                $ rake db:fixtures:load FIXTURES=data1.yml,data2.yml
              ]]></script>
              </td>
            </tr>
          </tbody>
        </table>

        <h2><a name="Models_NewRecords" href="#Models_NewRecords">Новыя экзэмпляры</a></h2>
        <p>Новы экзэмпляр пэўнай мадэлі можна стварыць пры дапамозе мэтаду <code>new</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          p = Person.new(:name => "John Doe")
        ]]></script>
        <p>А праверыць ці быў гэты экзэмпляр калі-небудзь захаваны ў базу даных (альбо існуе адно ў памяці) можна наступным чынам:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          p.new_record?         # => true
          p.save                # => true
          p.new_record?         # => false
        ]]></script>


        <h2><a name="Models_TrackingChanges" href="#Models_TrackingChanges">Сачэньне за зьменамі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/active-model.html">Nutshell</a></li>
            <li><a href="http://api.rubyonrails.org/classes/ActiveModel/Dirty.html">API</a></li>
          </ul>
        </div>
        <p>Часам у праграме трэба ведаць ці былі зроблены зьмены ў аб&#39;екце пасьля яго стварэньня і калі былі, то якія. Пры гэтым выкарыстоўваецца наступная тэрміналёгія: калі адзін ці некалькі атрыбутаў нейкага экзэмпляру былі зьмененыя, яго называюць брудным экзэмплярам; калі брудны экзэмпляр быў захаваны ў базу, ён ізноў становіцца чыстым. Для вызначэньня ці зьяўляецца экзэмпляр брудным выкарыстоўваецца мэтад <code>changed?</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          student.changed?                 # => false
          student.middle_name = 'Ambrose'
          student.changed?                 # => true
          student.save
          student.changed?                 # => false
        ]]></script>
        <p>Можна пайсьці далей і запытацца пра пэўныя з атрыбутаў, ці былі яны зьмененыя, і даведацца пра значэньні, якія яны ўтрымлівалі да зьмены:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          student.gpa = 3.22
          student.gpa_changed?             # => true
          student.gpa_was                  # => 3.14
          student.gpa_change               # => [3.22, 3.14]
        ]]></script>
        <p>Пры дапамозе мэтадаў <code>changed</code> і <code>changes</code> можна атрымаць сьпіс зьмененых атрыбутаў і гісторыю іх зьменаў:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          student.middle_name = 'David'
          student.changed                  # => ["gpa", "middle_name"]
          student.changes                  # => {"gpa" => [3.22, 3.14],
                                           #       "middle_name" => ["Ambrose", "David"]}
        ]]></script>
        <p>УВАГА! Калі атрыбут зьмяняецца без ужываньня апэрацыі прысваеньня, Active Record не ўсьвядоміць зьмены аўтаматычна і трэба кампанэнту дапамагчы зрабіць гэта:</p>
        <script type="syntaxhighlighter" class="brush: ruby; highlight: [2]"><![CDATA[
          student.save
          student.middle_name_will_change!
          student.middle_name_changed?     # => false
          student.middle_name << 'son'
          student.middle_name_change       # => ["David", "Davidson"]
        ]]></script>
        <p></p>

        <h2><a name="Models_Validations" href="#Models_Validations">Валідацыя даных</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/active_record_validations_callbacks.html">Guide</a></li>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/active-model.html">Nutshell</a></li>
          </ul>
        </div>
        <p>Адным з самых відавочных патрабаваньняў да мадэляў зьяўляецца валідацыя даных, якія плянуецца захаваць у базу даных. Асабліва гэта важна, калі праграма мае справу з данымі, якія ўводзіць карыстальнік: ён можа паспрабаваць выбраць у якасьці імені тое, якое ўжо было абрана іншым карыстальнікам, альбо паспрабуе ўвесьці нумар тэлефону ў поле, якое прызначана для захаваньня адрасу электроннай пошты, альбо забудзецца ўвесьці пацьверджаньне паролю. Ужо не кажучы пра зламысьнікаў, якія могуць паспрабаваць увесьці некарэктныя даныя ў праграму са злымі намерамі.</p>
        <p>У агульным выпадку валідацыю можна рабіць на наступных узроўнях:</p>
        <ul>
          <li>база даных&nbsp;&ndash; канстрэйнты і/ці захаваныя працэдуры. Хаця гэты ўзровень залежыць ад рэалізацыі базы даных і можа ўскладніць працэс тэставаньня праграмы, базы даных звычайна вельмі аптымізаваны пад задачы такога кшталту, і асабліва ў выпадку моцна нагружанага асяродку зьяўляецца найбольш пажаданым месцам для валідацыі;</li>
          <li>кліенцкі бок&nbsp;&ndash; валідацыя ўнутры браўзэра. Для карыстальніка гэты ўзровень зьяўляецца найбольш зручным, таму што водгук ад праграмы прыходзіць амаль імгненна і яму не прыходзіцца доўга чакаць толькі для таго, каб зразумець, што ён увёў нешта ня так. Але адваротны бок гэтага мэдалю ў тым, што па вялікаму рахунку спадзявацца на такую валідацыю ў праграме не выпадае&nbsp;&ndash; яна лёгка можа быць падмененая зламысьнікам;</li>
          <li>Rails-мадэлі&nbsp;&ndash; найбольш унівэрсальны ўзровень валідацыі, якая не залежыць ад рэалізацыі базы даных, не можа быць падмененая карыстальнікам, зручная пры тэставаньні і падтрымцы.</li>
        </ul>
        <p>Па вялікаму рахунку адна і тая ж валідацыя ў праграме можа быць рэалізавана на ўсіх трох узроўнях. Але ў межах гэтага даведніку разгледзім больш падрабязна валідацыю толькі на ўзроўні Rails-мадэляў. Напрыклад, наступны код будзе прадухіляць захаваньне/абнаўленьне такіх экзэмпляраў клясы <code>Video</code>, у якіх атрыбуты <code>title</code> і <code>embeded</code> не запоўненыя:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Video < ActiveRecord::Base
            validates :title, :embeded, :presence => true
          end
        ]]></script>
        <p>Калі ўбудаваных валідатараў не дастаткова, каб рэалізаваць патрэбную валідацыю, можна напісаць уласны валідатар:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Video < ActiveRecord::Base
            validates :title, :embeded, :presence => true
            validate :must_have_valid_embeded

            def must_have_valid_embeded
              unless embeded.include?("<iframe")
                errors.add(:embeded, "Must include an iframe tag")
              end
            end
          end
        ]]></script>
        <p>Мэтад <code>validate</code> выклікае мэтад-валідатар, імя якога было яму перададзена. Апошні ў сваю чаргу робіць патрэбныя праверкі і ў выпадку, калі экзэмпляр не праходзіць валідацыю, дадае ў яго калекцыю памылак адпаведнае паведамленьне з адпаведным ключом (<code>embeded</code> у прыкладзе вышэй).</p>

        <h3><a name="Models_Validations_WhenHappen" href="#Models_Validations_WhenHappen">Калі адбываецца валідацыя?</a></h3>
        <p>Валідацыя ў мадэлі адбываецца непасрэдна перад выклікам адпаведных SQL <code>INSERT...</code> альбо <code>UPDATE...</code> у залежнасьці ад таго, гэта <a href="#Models_NewRecords">новы экзэмпляр</a> ці ўжо існуючы. Але валідацыю запускаюць ня ўсе мэтады мадэлі, якія прыводзяць да захаваньня экзэмпляру ў базе даных. Мэтады, якія запускаюць валідацыю:</p>
        <ul>
          <li><code>create</code></li>
          <li><code>create!</code></li>
          <li><code>save</code></li>
          <li><code>save!</code></li>
          <li><code>update</code></li>
          <li><code>update_attributes</code></li>
          <li><code>update_attributes!</code></li>
        </ul>
        <p>Прычым варыянты мэтадаў з клічнікам ў выпадку неваліднага экзэмпляру кідаюць exception, а астатнія мэтады вяртаюць <code>false</code> (<code>save</code> і <code>update_attributes</code>), альбо сам экзэмпляр (<code>create</code> і <code>update</code>).</p>
        <p>Мэтады, якія НЕ запускаюць валідацыю, і, адпаведна, экзэмпляр да якога яны ўжываюцца, будзе захаваны ў базу незалежна ад таго валідны ён ці не, а таму павінны выкарыстоўвацца з асаблівай абачлівасьцю:</p>
        <ul>
          <li><code>decrement!</code></li>
          <li><code>decrement_counter</code></li>
          <li><code>increment!</code></li>
          <li><code>increment_counter</code></li>
          <li><code>toggle!</code></li>
          <li><code>touch</code></li>
          <li><code>update_all</code></li>
          <li><code>update_attribute</code></li>
          <li><code>update_column</code></li>
          <li><code>update_counters</code></li>
        </ul>
        <p>Таксама вышэйзгаданы мэтад <code>save</code> не запусьціць валідацыю, калі будзе выкліканы з аргумэнтам <code>:validate => false</code> (трэба ўжываць з асьцярогай!):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          save(:validate => false)
        ]]></script>

        <h3><a name="Models_Validations_Checking" href="#Models_Validations_Checking"><code>valid?</code> і <code>invalid?</code></a></h3>
        <p>Rails унутры сябе для праверкі валіднасьці выкарыстоўвае мэтады <code>valid?</code> і <code>invalid?</code>, якія могуць быць выкарыстаныя і на ўласныя мэты:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :name, :presence => true
          end

          Person.create(:name => "John Doe").valid?   # => true
          Person.create(:name => nil).valid?          # => false
        ]]></script>
        <p>Пасьля таго, як была выклікана валідацыя і было выяўлена, што экзэмпляр не валідны, усе паведамленьні пра адпаведныя памылкі даступныя праз мэтад <code>errors</code>, які вяртае <a href="../rubyRef/index.html#Types_Hashes">хэш</a>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :name, :presence => true
          end

          p = Person.new        # => #<Person id: nil, name: nil>
          p.errors              # => {}

          p.valid?              # => false
          p.errors              # => {:name => ["can't be blank"]}

          # Экзэмпляр ня будзе захаваны, таму што ня пройдзе валідацыю
          p = Person.create     # => #<Person id: nil, name: nil>
          p.errors              # => {:name => ["can't be blank"]}

          p.save                # => false

          p.save!               # => ActiveRecord::RecordInvalid:
                                #         Validation failed: Name cant be blank
        ]]></script>

        <h3><a name="Models_Validations_Builtin" href="#Models_Validations_Builtin">Убудаваныя валідатары</a></h3>
        <p>Мадэлі ў Rails маюць шэраг убудаваных валідатараў, кожны зь якіх мае дзьве формы запісу&nbsp;&ndash; поўную:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          validates :name, :presence => true
        ]]></script>
        <p>... і скарочаную:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          validates_presence_of :name
        ]]></script>
        <aside>Для зручнасьці пошуку інфармацыі ў якасьці загалоўкаў у дадзеным даведніку прывядзем скарочаныя вэрсіі валідатараў.</aside>
        <p>Пераважнай зьяўляецца поўная форма, таму што пры гэтым можна аб&#39;ядноўваць некалькі валідатараў у адным радку.</p>
        <p>Валідатарам можна перадаваць парамэтры (опцыі), <code>:presence => true</code> у прыкладзе вышэй. Акрамя спэцыфічных для кожнага з валідатараў, ёсьць шэраг парамэтраў, характэрных для ўсіх іх:</p>
        <ul>
          <li><code>:on</code>&nbsp;&ndash; вызначае калі павінна адбыцца валідацыя. Магчымыя значэньні: <code>:save</code> (змоўчнае; захаваньне экзэмпляру незалежна новы ён ці не), <code>:create</code> (толькі пры захаваньні новага экзэмпляру) і <code>:update</code> (толькі пры апдэйце ўжо існага экзэмпляру).</li>
          <li><code>:message</code>&nbsp;&ndash; вызначае паведамленьне ў выпадку, калі валідацыя не прайшла. Для кожнай з валідацыі існуе змоўчнае паведамленьне, якое будзе выкарыстана, калі гэты парамэтар не пазначаны.</li>
          <li><code>:if</code>&nbsp;&ndash; пазначае мэтад, працэдуру, альбо чараду для выкананьня, каб вызначыць ці павінна адбыцца валідацыя. Напрыклад:
            <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
              :if => :allow_validation

              # альбо
              :if => Proc.new { |user| user.signup_step > 2 }
            ]]></script>
          </li>

          <li><code>:unless</code>&nbsp;&ndash; пазначае мэтад, працэдуру, альбо чараду для выкананьня, каб вызначыць ці павінна валідацыя быць праігнаравана.</li>
          <li><code>:strict</code>&nbsp;&ndash; калі пазначаны гэты парамэтар са значэньнем <code>true</code> (змоўчным зьяўляецца значэньне <code>false</code>), альбо выкарыстоўваецца мэтад <code>validates!</code> (з клічнікам), валідацыя лічыцца строгай (ня можа быць выпраўленая карыстальнікам) і ў выпадку, калі яна не прайшла, замест запісу адпаведнага паведамленьня ў атрыбут мадэлі <code>errors</code> будзе кінуты эксэпшн <code>ActiveModel::StrictValidationFailed</code>.</li>
        </ul>
        <p>Ніжэй асобна разгледзім кожны з убудаваных валідатараў больш дэталёва.</p>

        <h4><a name="Models_Validations_Builtin_acceptance" href="#Models_Validations_Builtin_acceptance"><code>validates_acceptance_of</code></a></h4>
        <p>Правярае ці быў абраны пэўны чэкбокс (у агульным выпадку) пры сабміце формы. Звычайна гэтая валідацыя выкарыстоўваецца, калі карыстальнік павінен згадзіцца з умовамі сэрвісу, пацьвердзіць прачытаньне нейкага тэксту ці ў іншых падобных выпадках. Часта факт &laquo;прыняцьця&raquo; правяраецца толькі ў момант сабміту формы і не маецца патрэбы захоўваць гэтую інфармацыю ў базе даных, таму ў выпадку адсутнасьці адпаведнага атрыбуту мадэлі валідатар створыць віртуальны атрыбут:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :terms_of_service, :acceptance => true
          end
        ]]></script>
        <p>Чэкбокс для гэтага прыкладу можа быць сканструяваны наступным чынам:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          <% form_for @user do |user| %>
            ...
            <%= user.check_box :terms_of_service %>
          <% end %>
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:accept</code>&nbsp;&ndash; вызначае значэньне, якое будзе лічыцца за &laquo;прыняцьце&raquo; (змоўчным зьяўляецца значэньне <code>"1"</code>):
            <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
              validates :terms_of_service, :acceptance => { :accept => 'yes' }
            ]]></script>
          </li>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>true</code>.</li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для гэтага валідатара: <code>"must be accepted"</code>.</p>

        <h4><a name="Models_Validations_Builtin_confirmation" href="#Models_Validations_Builtin_confirmation"><code>validates_confirmation_of</code></a></h4>
        <p>Валідацыя зручна для праверкі значэньняў, якія на вью павінны быць уведзеныя карыстальнікам двойчы для выключэньня памылкі ўводу, напрыклад, значэньне паролю ці адрасу электроннай пошты:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :email, :confirmation => true
          end
        ]]></script>
        <p>адпаведнае вью можа выглядаць наступным чынам:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          <%= text_field :person, :email %>
          <%= text_field :person, :email_confirmation %>
        ]]></script>
        <p>Аднак трэба памятаць, што гэтая валідацыя спрацуе толькі, калі <code>email_confirmation</code> ня <code>nil</code>. Для запуску валідацыі ў любым выпадку, незалежна ад значэньня атрыбуту <code>email_confirmation</code>, трэба дадаць валідацыю абавязковасьці:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :email, :confirmation => true
            validates :email_confirmation, :presence => true
          end
        ]]></script>
        <p>Змоўчны тэкст паведамленьня для гэтага валідатара: <code>"doesn’t match confirmation"</code>.</p>

        <h4><a name="Models_Validations_Builtin_exclusion" href="#Models_Validations_Builtin_exclusion"><code>validates_exclusion_of</code></a></h4>
        <p>Правярае, каб атрыбут мадэлі не прымаў значэньні з пэўнага шэрагу:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Account < ActiveRecord::Base
            validates :subdomain, :exclusion => { :in => %w(www us ca jp),
              :message => "Subdomain %{value} is reserved." }
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:allow_blank</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар не запоўнены (роўны <code>nil</code> альбо пустой чарадзе напрыклад). Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:in</code> (які мае аліас <code>:within</code>)&nbsp;&ndash; вызначае шэраг значэньняў для выключэньня.</li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для гэтага валідатара: <code>"is reserved"</code>.</p>

        <h4><a name="Models_Validations_Builtin_format" href="#Models_Validations_Builtin_format"><code>validates_format_of</code></a></h4>
        <p>Правярае, каб значэньне атрыбуту мадэлі адпавядала (альбо наадварот, НЕ адпавядала) пэўнаму рэгулярнаму выразу:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class User < ActiveRecord::Base
            validates :email, :format => { :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i }
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:allow_blank</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар не запоўнены (роўны <code>nil</code> альбо пустой чарадзе напрыклад). Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:with</code>&nbsp;&ndash; рэгулярны выраз, якому павінна адпавядаць значэньне атрыбуту. Замест самога рэгулярнага выразу можа стаяць працэдура (лямбда), якая вяртае рэгулярны выраз дынамічна.</li>
          <li><code>:without</code>&nbsp;&ndash; рэгулярны выраз, якому НЕ павінна адпавядаць значэньне атрыбуту. Замест самога рэгулярнага выразу можа стаяць працэдура (лямбда), якая вяртае рэгулярны выраз дынамічна.</li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для гэтага валідатара: <code>"is invalid"</code>.</p>
        <p>Прывядзем дадатковыя прыклады:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates_format_of :email, :without => %rNOSPAM/
          end
        ]]></script>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            # Admin can have number as a first letter in their screen name
            validates_format_of :screen_name,
                                :with => lambda{ |person| person.admin? ? %r\A[a-z0-9][a-z0-9_\-]*\Z/
                                    : %r\A[a-z][a-z0-9_\-]*\Z/ }
          end
        ]]></script>

        <h4><a name="Models_Validations_Builtin_inclusion" href="#Models_Validations_Builtin_inclusion"><code>validates_inclusion_of</code></a></h4>
        <p>Правярае, каб атрыбут мадэлі прымаў значэньні толькі з пэўнага шэрагу:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class User < ActiveRecord::Base
            validates_inclusion_of :date_of_birth,
              :in => (130.years.ago.to_date .. Date.today),
              :message => "must be at least plausibly human"
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:allow_blank</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар не запоўнены (роўны <code>nil</code> альбо пустой чарадзе напрыклад). Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:in</code> (ці <code>:within</code>)&nbsp;&ndash; вызначае шэраг значэньняў, якія можа прымаць атрыбут.</li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для гэтага валідатара: <code>"is not included in the list"</code>.</p>

        <h4><a name="Models_Validations_Builtin_length" href="#Models_Validations_Builtin_length"><code>validates_length_of</code> (ці <code>validates_size_of</code>)</a></h4>
        <p>Правярае, каб атрыбут мадэлі прымаў значэньні пэўнай даўжыні (роўна, больш/менш, альбо дыяпазону даўжынь):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :first_name,  :length => { :maximum => 30 }
            validates :last_name,   :length => { :maximum => 30,
                                        :message => "less than 30 if you don't mind" }
            validates :fax,         :length => { :in => 7..32, :allow_nil => true }
            validates :phone,       :length => { :in => 7..32, :allow_blank => true }
            validates :user_name,   :length => { :within => 6..20,
                                        :too_long => "pick a shorter name",
                                        :too_short => "pick a longer name" }
            validates :zip_code,    :length => { :minimum => 5,
                                        :too_short => "please enter at least 5 characters" }
            validates :smurf_leader,:length => { :is => 4,
                            :message => "papa is spelled with 4 characters... don't play me." }
            validates :essay,       :length => { :minimum => 100,
                                        :too_short => "Your essay must be at least 100 words.",
                                        :tokenizer => lambda { |str| str.scan(%r\w+/) } }
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:allow_blank</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар не запоўнены (роўны <code>nil</code> альбо пустой чарадзе напрыклад). Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:in</code> (ці <code>:within</code>)&nbsp;&ndash; вызначае дыяпазон даўжынь атрыбуту.</li>
          <li><code>:is</code>&nbsp;&ndash; вызначае дакладную даўжыню атрыбуту.</li>
          <li><code>:maximum</code>&nbsp;&ndash; вызначае максымальную даўжыню атрыбуту.</li>
          <li><code>:minimum</code>&nbsp;&ndash; вызначае мінімальную даўжыню атрыбуту.</li>
          <li><code>:too_long</code>&nbsp;&ndash; значэньне паведамленьня для выпадку, калі даўжыня атрыбуту перавышае максымальна магчымае. Змоўчнае значэньне: <code>"is too long (maximum is %{count} characters)"</code>.</li>
          <li><code>:too_short</code>&nbsp;&ndash; значэньне паведамленьня для выпадку, калі даўжыня атрыбуту меншае за мінімальна магчымае. Змоўчнае значэньне: <code>"is too short (min is %{count} characters)"</code>.</li>
          <li><code>:tokenizer</code>&nbsp;&ndash; вызначае якім чынам чарада атрыбуту павінна быць разьбітая для падліку яе даўжыні. Напрыклад, у выпадку <code>:tokenizer => lambda { |str| str.scan(/\w+/) }</code> за даўжыню будзе лічыцца колькасьць словаў у чарадзе. Змоўчнае значэньне: <code>lambda { |value| value.split(//) }</code>, пры якім за даўжыню будзе лічыцца колькасьць сымбаляў у чарадзе.</li>
          <li><code>:wrong_length</code>&nbsp;&ndash; значэньне паведамленьня для выпадку, калі даўжыня атрыбуту адрозьніваецца ад дакладнай даўжыні, пазначанай ў парамэтры <code>:is</code>. Змоўчнае значэньне: <code>"is the wrong length should be %{count} characters)"</code>.</li>
        </ul>
        <p>Для вызначэньня агульнага (для ўсіх выпадкаў) паведамленьня як і звычайна можна выкарыстоўваць парамэтар <code>:message</code>.</p>

        <h4><a name="Models_Validations_Builtin_numericality" href="#Models_Validations_Builtin_numericality"><code>validates_numericality_of</code></a></h4>
        <p>Правярае, каб атрыбут мадэлі прымаў толькі лічбавыя значэньні:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Player < ActiveRecord::Base
            validates :points, :numericality => true
            validates :games_played, :numericality => { :only_integer => true }
          end

          class Person < ActiveRecord::Base
            validates :width, :numericality => { :less_than => Proc.new { |person| person.height } }
            validates :width, :numericality => { :greater_than => :minimum_width }
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:allow_nil</code>&nbsp;&ndash; прапусьціць валідацыю, калі парамэтар роўны <code>nil</code>. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>.</li>
          <li><code>:equal_to</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць роўнае пазначанаму. Змоўчнае значэньне паведамленьня: <code>"must be equal to %{count}"</code>.</li>
          <li><code>:even</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць цотным. Змоўчнае значэньне паведамленьня: <code>"must be even"</code>.</li>
          <li><code>:greater_than</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць больш за пазначанае. Змоўчнае значэньне паведамленьня: <code>"must be greater than %{count}"</code>.</li>
          <li><code>:greater_than_or_equal_to</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць больш альбо роўнае пазначанаму. Змоўчнае значэньне паведамленьня: <code>"must be greater than or equal to %{count}"</code>.</li>
          <li><code>:less_than</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць менш за пазначанае.  Змоўчнае значэньне паведамленьня: <code>"must be less than %{count}"</code>.</li>
          <li><code>:less_than_or_equal_to</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць менш альбо роўнае пазначанаму. Змоўчнае значэньне паведамленьня: <code>"must be less than or equal to %{count}"</code>.</li>
          <li><code>:odd</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць няцотным. Змоўчнае значэньне паведамленьня: <code>"must be odd"</code>.</li>
          <li><code>:only_integer</code>&nbsp;&ndash; вызначае, што значэньне атрыбуту павінна быць толькі цэлым лікам. Змоўчнае значэньне&nbsp;&ndash; <code>false</code>. Змоўчнае значэньне паведамленьня: <code>"must be whole number"</code>.</li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для астатніх выпадкаў: <code>"is not a number"</code>.</p>

        <h4><a name="Models_Validations_Builtin_presence" href="#Models_Validations_Builtin_presence"><code>validates_presence_of</code></a></h4>
        <p>Правярае, каб атрыбут быў не пустым (быў запоўненым):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates :email, :presence => true
          end
        ]]></script>
        <p>У выпадку, калі трэба праверыць ці запоўненая асацыяцыя (зьвязаная запіс), трэба правяраць наяўнасьць не самой асацыяцыі, а зьнешняга ключа да яе:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class LineItem < ActiveRecord::Base
            belongs_to :order
            validates :order_id, :presence => true
          end
        ]]></script>
        <p>Улічваючы, што <code>false.blank?</code> верне значэньне <code>true</code>, правяраць запоўненасьць булевых атрыбутаў трэба інакш:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          validates :boolean_field_name, :inclusion => { :in => [true, false] }
        ]]></script>
        <p>Змоўчны тэкст паведамленьня для гэтай валідацыі: <code>"can’t be empty"</code>.</p>

        <aside>Трэба памятаць, што праверка ўнікальнасьці адбываецца не за конт канстрэйнта базы даных і цалкам магчыма, што розныя канэкшэны да базы даных адначасова створаць запісы з аднолькавым значэньнем у такім полі. Таму гэтую валідацыю варта заўсёды суправаджаць адпаведным канстрэйнтам базы даных.</aside>
        <h4><a name="Models_Validations_Builtin_uniqueness" href="#Models_Validations_Builtin_uniqueness"><code>validates_uniqueness_of</code></a></h4>
        <p>Правярае, каб атрыбут меў унікальнае значэньне (сярод усіх запісаў ці па дадатковай умове):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Account < ActiveRecord::Base
            validates :email, :uniqueness => true
          end
        ]]></script>
        <p>Дадатковыя парамэтры:</p>
        <ul>
          <li><code>:case_sensitive</code>&nbsp;&ndash; вызначае ці з улікам рэгістру (значэньне <code>true</code>) рабіць праверку унікальнасьці. Змоўчнае значэньне&nbsp;&ndash; <code>true</code>.
            <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
              class Person < ActiveRecord::Base
                validates :name, :uniqueness => { :case_sensitive => false }
              end
            ]]></script>
          </li>
          <li><code>:scope</code>&nbsp;&ndash; пазначае дадатковы атрыбут, які будзе ўлічвацца ў вызначэньні ўнікальнасьці (каб зьменшыць «маштаб» унікальнасьці):
            <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
              class Holiday < ActiveRecord::Base
                validates :name, :uniqueness => { :scope => :year,
                  :message => "should happen once per year" }
              end
            ]]></script>
          </li>
        </ul>
        <p>Змоўчны тэкст паведамленьня для гэтай валідацыі: <code>"has already been taken"</code>.</p>

        <h3><a name="Models_Validations_Custom" href="#Models_Validations_Custom">Уласныя валідатары</a></h3>
        <p>Акрамя ўбудаваных валідатараў, калі яны ня здольныя вырашыць пастаўленую задачу, можна скарыстацца уласнымі.</p>

        <h4><a name="Models_Validations_Custom_Attributes" href="#Models_Validations_Custom_Attributes">Валідацыя атрыбутаў</a></h4>
        <p>Уласная валідацыя асобных атрыбутаў магчымая, па-першае, праз стварэньне клясаў-валідатараў, спадчыньнікаў ад <code>ActiveModel::EachValidator</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class EmailValidator < ActiveModel::EachValidator
            def validate_each(record, attribute, value)
              unless value =~ /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i
                record.errors[attribute] << (options[:message] || "is not an email")
              end
            end
          end

          class Person < ActiveRecord::Base
            validates :email, :presence => true, :email => true
          end
        ]]></script>
        <p>Мэтад <code>validate_each</code> гэтага валідатару ў якасьці парамэтраў прымае сам экзэмпляр (<code>record</code>), імя атрыбуту (<code>attr</code>) і ягонае значэньне (<code>value</code>). Зьвярніце ўвагу як пазначаецца валідатар: <code>:email => true</code>, а імя валідатара пры гэтым <code>EmailValidator</code>. Таксама зьвярніце ўвагу, як у апошнім прыкладзе камбінуюцца убудаваны і ўласны валідатары.</p>
        <p>Акрамя гэтага для валідацыі атрыбутаў можна скарыстацца макрасам <code>validates_each</code>, якому перадаецца ліст атрыбутаў для праверкі і блёк, які прымае тыя ж парамэтры <code>record</code>, <code>attr</code> і <code>value</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Person < ActiveRecord::Base
            validates_each :name, :surname do |record, attr, value|
              record.errors.add(attr, 'must start with upper case') if value =~ /\A[a-z]/
            end
          end
        ]]></script>

        <h4><a name="Models_Validations_Custom_Instances" href="#Models_Validations_Custom_Instances">Валідацыя экзэмпляраў</a></h4>
        <p>Для праверкі цалкам усяго экзэмпляру можна скарыстацца макрасам <code>validates_with</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class Person < ActiveRecord::Base
            validates_with GoodnessValidator
          end

          class GoodnessValidator < ActiveModel::Validator
            def validate(record)
              if record.first_name == "Evil"
                record.errors[:base] << "This person is evil"
              end
            end
          end
        ]]></script>
        <p>Зьвярніце ўвагу на тое, што паведамленьні аб памылцы, дададзеныя ў хэш <code>errors</code> з ключом <code>:base</code> адносяцца не да пэўнага атрыбуту, але да ўсяго экзэмпляру.</p>
        <p>У валідатары акрамя стандартных можна перадаваць дадатковыя парамэтры, доступ да якіх у клясе валідатара будзе магчымы праз хэш <code>options</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby; highlight: [2,7]"><![CDATA[
          class Person < ActiveRecord::Base
            validates_with GoodnessValidator, :fields => [:first_name, :last_name]
          end

          class GoodnessValidator < ActiveModel::Validator
            def validate(record)
              if options[:fields].any?{|field| record.send(field) == "Evil" }
                record.errors[:base] << "This person is evil"
              end
            end
          end
        ]]></script>

        <h4><a name="Models_Validations_Custom_Methods" href="#Models_Validations_Custom_Methods">Мэтады-валідатары</a></h4>
        <p>Таксама ўласную валідацыю можна стварыць праз звычайны мэтад мадэлі:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Invoice < ActiveRecord::Base
            validate :expiration_date_cannot_be_in_the_past,
              :discount_cannot_be_greater_than_total_value

            def expiration_date_cannot_be_in_the_past
              if !expiration_date.blank? and expiration_date < Date.today
                errors.add(:expiration_date, "can't be in the past")
              end
            end

            def discount_cannot_be_greater_than_total_value
              if discount > total_value
                errors.add(:discount, "can't be greater than total value")
              end
            end
          end
        ]]></script>

        <h3><a name="Models_Validations_Conditional" href="#Models_Validations_Conditional">Умоўная валідацыя</a></h3>
        <p>Як ужо адзначалася вышэй, кожны з валідатараў можа прымаць парамэтры <code>:if</code> і <code>:unless</code>, якія ўплываюць на тое, пры якіх умовах валідатары будуць выкананыя ці праігнараваныя. Значэньнем гэтых парамэтраў можа быць <a href="../rubyRef/index.html#Types_Symbols">сымбаль</a>, які павінен адпавядаць імені аднаго з мэтадаў:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Order < ActiveRecord::Base
            validates :card_number, :presence => true, :if => :paid_with_card?

            def paid_with_card?
              payment_type == "card"
            end
          end
        ]]></script>
        <p>...альбо сымбальная чарада, якая павінна ўтрымліваць валідны Ruby-код (выкарыстаньне варта абмяжоўваць толькі вельмі кароткімі ўмовамі):</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Person < ActiveRecord::Base
            validates :surname, :presence => true, :if => "name.nil?"
          end
        ]]></script>
        <p>...альбо аб&#39;ект <code>Proc</code>, які будзе ўтрымліваць код неабходнай умовы:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Account < ActiveRecord::Base
            validates :password, :confirmation => true,
              :unless => Proc.new { |a| a.password.blank? }
          end
        ]]></script>
        <p>Калі патрэбна, каб некалькі валідатараў спрацоўвалі па адной і той жа умове, можна скарыстацца макрасам <code>with_options</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class User < ActiveRecord::Base
            with_options :if => :is_admin? do |admin|
              admin.validates :password, :length => { :minimum => 10 }
              admin.validates :email, :presence => true
            end
          end
        ]]></script>

        <h3><a name="Models_Validations_ErrorMessages" href="#Models_Validations_ErrorMessages">Паведамленьні аб памылках валідацыі</a></h3>
        <p>Атрыбут мадэляў <code>errors</code> зьяўляецца экзэмплярам клясы <code>ActiveModel::Errors</code> і ўтрымлівае ўсе паведамленьні аб памылках валідацыі:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Person < ActiveRecord::Base
            validates :name, :presence => true, :length => { :minimum => 3 }
          end

          person = Person.new
          person.valid? # => false
          person.errors # => {:name => ["can't be blank", "is too short (minimum is 3 characters)"]}

          person = Person.new(:name => "John Doe")
          person.valid? # => true
          person.errors # => {}
        ]]></script>
        <p>Мэтад <code>errors[]</code> верне кантэйнэр паведамленьняў аб памылках для пэўнага атрыбуту:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          person = Person.new(:name => "JD")
          person.valid? # => false
          person.errors[:name] # => ["is too short (minimum is 3 characters)"]
        ]]></script>
        <p>Мэтад <code>add</code> атрыбуту <code>errors</code>, дазваляе дадаваць новыя паведамленьні аб памылках валідацыі, а мэтад <code>clear</code> таго ж атрыбуту робіць кантэйнэр паведамленьняў пустым. Мэтады <code>full_messages</code> і <code>to_a</code> кантэйнэру вярнуць усе паведамленьні аб памылках у форме, у якой яны могуць быць прадстаўленыя карыстальніку.</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Person < ActiveRecord::Base
            def a_method_used_for_validation_purposes
              errors.add(:name, "cannot contain the characters !@#%*()_-+=")
            end
          end

          person = Person.create(:name => "!@#")
          person.errors.full_messages # => ["Name cannot contain the characters !@#%*()_-+="]
        ]]></script>
        <p>Акрамя паведамленьняў аб памылках для пэўных атрыбутаў, <code>errors</code> утрымлівае паведамленьні аб памылках, якія адносяцца да ўсяго экзэмпляру мадэлі, пад адмысловым ключом <code>:base</code>.</p>

        <h2><a name="Models_Callbacks" href="#Models_Callbacks">Зваротныя выклікі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/active_record_validations_callbacks.html">Guide</a></li>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/active-model.html">Nutshell</a></li>
          </ul>
        </div>
        <p>Зваротныя выклікі&nbsp;&ndash; гэта пэўныя кавалкі коду, якія выклікаюцца ў пэўныя моманты жыцьцёвага шляху экзэмпляраў мадэляў. Пры дапамозе зваротных выклікаў магчыма выконваць нейкі код кожны раз, калі экзэмпляр ствараецца, загружаецца, захоўваецца, абнаўляецца, праходзіць валідацыю ці выдаляецца.</p>
        <p>У якасьці зваротных выклікаў могуць выкарыстоўвацца звычайныя мэтады:</p>
        <script type="syntaxhighlighter" class="brush: ruby; highlight: [4,8,9,10,11,12]"><![CDATA[
          class User < ActiveRecord::Base
            validates :login, :email, :presence => true

            before_validation :ensure_login_has_a_value

            private

              def ensure_login_has_a_value
                if login.nil?
                  self.login = email unless email.blank?
                end
              end
          end
        ]]></script>
        <p>... альбо блёкі, калі гэта вельмі кароткі фрагмэнт коду (1-2 радкі):</p>
        <script type="syntaxhighlighter" class="brush: ruby; highlight: [4,5,6]"><![CDATA[
          class User < ActiveRecord::Base
            validates :login, :email, :presence => true

            before_create do |user|
              user.name = user.login.capitalize if user.name.blank?
            end
          end
        ]]></script>
        <p>Лічыцца добрай практыкай мэтады, якія ўжываюцца як зваротныя выклікі, рабіць <code>private</code> ці <code>protected</code>.</p>

        <h3><a name="Models_Callbacks_Types" href="#Models_Callbacks_Types">Тыпы зваротных выклікаў</a></h3>
        <p>Ніжэй пералічаны тыпы зваротных выклікаў у той пасьлядоўнасьці (у межах адпаведнай апэрацыі), у якой яны будуць выклікацца, незалежна ад той пасьлядоўнасьці, у якой яны зьмешчаны ў кодзе праграмы.</p>

        <h4><a name="Models_Callbacks_Types_CreatingObject" href="#Models_Callbacks_Types_CreatingObject">Стварэньне аб&#39;екту</a></h4>
        <ul>
          <li><code>before_validation</code></li>
          <li><code>after_validation</code></li>
          <li><code>before_save</code></li>
          <li><code>around_save</code></li>
          <li><code>before_create</code></li>
          <li><code>around_create</code></li>
          <li><code>after_create</code></li>
          <li><code>after_save</code></li>
        </ul>

        <h4><a name="Models_Callbacks_Types_UpdatingObject" href="#Models_Callbacks_Types_UpdatingObject">Абнаўленьне аб'екту</a></h4>
        <ul>
          <li><code>before_validation</code></li>
          <li><code>after_validation</code></li>
          <li><code>before_save</code></li>
          <li><code>around_save</code></li>
          <li><code>before_update</code></li>
          <li><code>around_update</code></li>
          <li><code>after_update</code></li>
          <li><code>after_save</code></li>
        </ul>

        <h4><a name="Models_Callbacks_Types_DestroyingObject" href="#Models_Callbacks_Types_DestroyingObject">Выдаленьне аб'екту</a></h4>
        <ul>
          <li><code>before_destroy</code></li>
          <li><code>around_destroy</code></li>
          <li><code>after_destroy</code></li>
        </ul>

        <h4><a name="Models_Callbacks_Types_InitializingObject" href="#Models_Callbacks_Types_InitializingObject"><code>after_initialize</code> і <code>after_find</code></a></h4>
        <p>Зваротны выклік <code>after_initialize</code> выклікаецца кожны раз, калі экзэмпляр ствараецца ў памяці кампутара&nbsp;&ndash; альбо праз наўпроставае ініцыіраваньне (выклік мэтаду <code>new</code>), альбо праз загрузку яго з базы даных.</p>
        <p>Зваротны выклік <code>after_find</code> выклікаецца кожны раз, калі Active Record вычытвае запіс з базы даных. Ён выклікаецца да выкліку <code>after_initialize</code>, калі абодва зарэгістраваныя:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class User < ActiveRecord::Base
            after_initialize do |user|
              puts "You have initialized an object!"
            end

            after_find do |user|
              puts "You have found an object!"
            end
          end

          >> User.new
          You have initialized an object!
          => #<User id: nil>

          >> User.first
          You have found an object!
          You have initialized an object!
          => #<User id: 1>
        ]]></script>

        <h3><a name="Models_Callbacks_RunningCallbacks" href="#Models_Callbacks_RunningCallbacks">Калі выконваюцца зваротныя выклікі</a></h3>
        <p>Наступныя мэтады мадэляў прыводзяць да запуску адпаведных зваротных выклікаў:</p>
        <ul>
          <li><code>create</code></li>
          <li><code>create!</code></li>
          <li><code>decrement!</code></li>
          <li><code>destroy</code></li>
          <li><code>destroy_all</code></li>
          <li><code>increment!</code></li>
          <li><code>save</code></li>
          <li><code>save!</code></li>
          <li><code>save(:validate => false)</code></li>
          <li><code>toggle!</code></li>
          <li><code>update</code></li>
          <li><code>update_attribute</code></li>
          <li><code>update_attributes</code></li>
          <li><code>update_attributes!</code></li>
          <li><code>valid?</code></li>
        </ul>
        <p>Наступныя мэтады мадэляў прыводзяць да запуску зваротнага выкліку <code>after_find</code>:</p>
        <ul>
          <li><code>all</code></li>
          <li><code>first</code></li>
          <li><code>find</code></li>
          <li><code>find_all_by_attribute</code></li>
          <li><code>find_by_attribute</code></li>
          <li><code>find_by_attribute!</code></li>
          <li><code>last</code></li>
        </ul>
        <p>Зваротны выклік <code>after_initialize</code> запускаецца кожны раз, калі ў памяці кампутара ствараецца экзэмпляр мадэлі.</p>
        <p>Наступныя мэтады мадэляў НЕ прыводзяць да запуску адпаведных зваротных выклікаў:</p>
        <ul>
          <li><code>decrement</code></li>
          <li><code>decrement_counter</code></li>
          <li><code>delete</code></li>
          <li><code>delete_all</code></li>
          <li><code>find_by_sql</code></li>
          <li><code>increment</code></li>
          <li><code>increment_counter</code></li>
          <li><code>toggle</code></li>
          <li><code>touch</code></li>
          <li><code>update_column</code></li>
          <li><code>update_all</code></li>
          <li><code>update_counters</code></li>
        </ul>

        <h3><a name="Models_Callbacks_HaltingExecution" href="#Models_Callbacks_HaltingExecution">Адкат транзакцыі</a></h3>
        <p>Усе валідатары і зваротныя выклікі, якія тычыцца пэўнай каманды мадэлі, зьмяшчаюцца ў чараду для выкананьня. Гэтая чарада абгортваецца транзакцыяй базы даных (калі база падтрымлівае транзакцыі). У выпадку, калі <i>before</i>-выклік вяртае <code>false</code> ці кідае выключэньне, уся транзакцыя будзе адкочаная. Але <i>after</i>-выклік прывядзе да адкату толькі ў выпадку кіданьня выключэньня.</p>

        <h3><a name="Models_Callbacks_Conditional" href="#Models_Callbacks_Conditional">Умоўныя выклікі</a></h3>
        <p>Як і ў выпадку <a href="#Models_Validations_Conditional">валідатараў</a> выкананьне зваротных выклікаў можна абстаўляць пэўнымі ўмовамі. Праз падабенства ўжываньня з валідатарамі падрабязна спыняцца ня будзем, а проста прывядзем шэраг прыкладаў:</p>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Order < ActiveRecord::Base
            before_save :normalize_card_number, :if => :paid_with_card?
          end
        ]]></script>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Order < ActiveRecord::Base
            before_save :normalize_card_number, :if => "paid_with_card?"
          end
        ]]></script>
        <script type="syntaxhighlighter" class="brush: ruby;"><![CDATA[
          class Order < ActiveRecord::Base
            before_save :normalize_card_number,
              :if => Proc.new { |order| order.paid_with_card? }
          end
        ]]></script>



        <h2><a name="Models_Associations" href="#Models_Associations">Асацыяцыі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/association_basics.html">Guide</a></li>
          </ul>
        </div>

        <h2><a name="Models_Querying" href="#Models_Querying">Састаўленьне запытаў</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/active_record_querying.html">Guide</a></li>
          </ul>
        </div>
      </section>

      <section>
        <h1><a name="Views">Вью</a></h1>

        <p>Вью&nbsp;&mdash; гэта тое, што карыстальнік праграмы бачыць і чаго &laquo;кранаецца&raquo;. У агульным выпадку вью адлюстроўвае даныя мадэлі альбо формы, аднак можа вывадзіць і XML для RSS-рыдэраў ці JSON для пэўнага API.</p>
        <p>Rails прадстаўляе гэты прэзэнтацыйны ўзровень пры дапамозе кампанэнта Action View, які ўключае сыстэму шаблёнаў, якая завецца <i>embedded Ruby</i> (ERB) і выдатна падыходзіць для стварэньня <a href="../htmlRef/index.html">HTML</a>-дакумэнтаў:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          <h1>All People</h1>
          <ul>
          <% Person.all.each do |person| %>
            <li><%= person.name %> is having a birthday
              in <%= distance_of_time_in_words_to_now(person.birthday) %></li>
          <% end %>
          </ul>
        ]]></script>
        <p>Пры гэтым код у тэгах <code>&lt;%&nbsp;…&nbsp;%&gt;</code> апрацоўваецца, аднак не выводзіцца ў дакумэнт (звычайна так запісваюцца ўмовы і цыклі). Код жа ў тэгах <code>&lt;%=&nbsp;…&nbsp;%&gt;</code> апрацоўваецца і яго вынік выводзіцца ў выніковы дакумэнт. У выніку апрацоўкі шаблёну з папярэдняга прыкладу будзе сфармаваны прыкладна такі дакумэнт:</p>
        <script type="syntaxhighlighter" class="brush: html"><![CDATA[
          <h1>All People</h1>
          <ul>
            <li>Edward is having a birthday in 11 days</li>
            <li>James is having a birthday in 11 days</li>
            <li>John is having a birthday in 156 days</li>
            <li>Cody is having a birthday in 90 days</li>
          </ul>
        ]]></script>
        <p><code>distance_of_time_in_words_to_now</code>&nbsp;&mdash; ідзін з <a href="http://api.rubyonrails.org/classes/ActionView/Helpers.html">дапаможных мэтадаў</a>, якія ўключае ў сябе Action View.</p>

        <h2><a name="Views_LayoutsRendering">Макеты і візуалізацыя ў Rails</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/layouts_and_rendering.html">Guide</a></li>
          </ul>
        </div>

        <h2><a name="Views_FormHelpers">Дапаможнікі формаў</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/form_helpers.html">Guide</a></li>
          </ul>
        </div>
        <p>Formtastic plugin: <a href="https://github.com/justinfrench/formtastic">https://github.com/justinfrench/formtastic</a></p>
      </section>

      <section>
        <h1><a name="Controllers">Кантролеры</a></h1>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html">Overview</a></li>
          </ul>
        </div>

        <p>Кампанэнт Action Controller кіруе жыцьцёвым цыклям Rails-запытаў: прымае HTTP-запыты, атрымлівае даныя з мадэляў і візуалізіруе вью. Для спрашчэньня працы распрацоўшчыка ён прадстаўляе аўтаматычнае лагіраваньне, <i>benchmarking</i>, кэшаваньне, кіраваньне сэсіямі і cookies, а таксама іншыя цікавыя магчымасьці як фільтры, якія выклікаюць нейкі код да дзеі ці пасьля яе, што вельмі зручна напрыклад для убудаваньня аўтэнтыфікацыі.</p>
        <p>Яшчэ Action Controller аўтаматычна зьвязвае пэўную дзею з адпаведным вью. Разгледзім фрагмэнт тыповага кантролеру:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          class PeopleController < ApplicationController
            before_filter :ensure_user_is_authenticated

            def index
              @people = Person.all

              respond_to do |format|
                format.html # index.html.erb
                format.json  { render :json => @people }
              end
            end

            # ...

          end
        ]]></script>
        <p>Калі прыходзіць запыт на URI <code>http://some-app.com/people/index.html</code> мэтад <code>index</code> кантролеру <code>PeopleController</code> будзе шукаць шаблён з такім жа імем і фарматам: <code>index.html.erb</code></p>
        <p>Што яшчэ больш цікава і зручна, гэта што Action Controller можа адказваць тым жа самым мэтадам (дзеяй) на запыты розных фарматаў: на URI <code>http://some-app.com/people/index.json</code> той жа самы мэтад <code>index</code> кантролеру <code>PeopleController</code> з прыкладу вышэй адкажа JSON-дакумэнтам.</p>

        <h2><a name="Controllers_Routing">Разводка</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/routing.html">Routing</a></li>
          </ul>
        </div>
        <p>Які мэтад якога кантролера адказны за чарговы запыт звонку вызначае кампанэнт разводкі (<i>routing</i>)&nbsp;&mdash; Action Dispatch. Каб пабачыць усе магчымыя запыты (шляхі), якія праграма наладжана апрацоўваць, можна скарыстацца камандай <code>rake routes</code>:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
          $ rake routes

              videos GET    /videos(.:format)          {:controller=>"videos", :action=>"index"}
                     POST   /videos(.:format)          {:controller=>"videos", :action=>"create"}
           new_video GET    /videos/new(.:format)      {:controller=>"videos", :action=>"new"}
          edit_video GET    /videos/:id/edit(.:format) {:controller=>"videos", :action=>"edit"}
               video GET    /videos/:id(.:format)      {:controller=>"videos", :action=>"show"}
                     PUT    /videos/:id(.:format)      {:controller=>"videos", :action=>"update"}
                     DELETE /videos/:id(.:format)      {:controller=>"videos", :action=>"destroy"}
        ]]></script>
        <aside>Public-мэтады кантролераў, якія прызначаны для апрацоўкі запытаў называюцца <i>дзеямі</i> (<i>actions</i>). А працэс знаходжаньня сувязі паміж шляхам і адпаведнай дзеяй кантролеру называецца <i>разводкай</i> (<i>routing</i>).</aside>
        <p>З гэтай трасіроўкі можна даведацца пра ролю, якую граюць HTTP-выказьнікі ў працэсе разводкі: адзін і той жа шлях <code>/videos</code> будзе накіраваны для апрацоўкі ў розныя мэтады кантролеру <code>VideosController</code> у залежнасьці ад таго быў выкарыстаны выказьнік GET альбо POST. У аснове такога падыходу ляжыць рэалізацыя ідэі RESTful-разводкі, якая між іншым вызначае відавочнасьць і прадказуемасьць выкарыстоўваемых шляхоў. Напрыклад, HTTP-запыт DELETE, дасланы па шляху <code>/videos/1</code>, будзе азначаць запыт на выдаленьне відэа-запісу з ID роўным 1. Як вынікае з апошняга сьцьверджаньня <code>:id</code>-частка у шляху зьяўляецца замяшчальнікам рэальнага ID экзэмпляру.</p>
        <p>Запісваецца разводка праграмы ў файле <code>config/routes.rb</code>. Для вызначэньня ўсіх тых шляхоў, якія былі выведзены ў трасіроўцы вышэй, і якія зьяўляюцца змоўчнымі для Rails-праграмы дастаткова ўсяго аднаго радку ў гэтым файле разводкі:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          resources :videos
        ]]></script>
        <p>Гэты радок зьяўляецца нічым іншым, як выклікам мэтаду, які наладжвае стандартную RESTful-разводку для відэа-рэсурсаў праграмы.</p>

        <h2><a name="Controllers_Parameters">Парамэтры</a></h2>
        <p>Часам у кантролерах трэба мець доступ да даных, пераданых карыстальнікам, ці да іншых парамэтраў праграмы. Існуе 2 віды парамэтраў, даступныя ў любой сеціўнай праграме. Першыя&nbsp;&mdash; дасылаемые ў складзе <abbr class="term" title="Uniform Resource Locator">URL</abbr>'а (<i>query string parameters</i>). Гэтыя парамэтры пазначаюцца ў адрасным радку праз пытальнік пасьля ўласна адрасу. Другі від парамэтраў перадаецца як частка <code>POST</code>-запыту і зьяўляецца звычайна данымі, каторыя карыстальнік увёў у <a href="../htmlRef/index.html">HTML</a>-форму. Нягледзячы на дзьве розныя прыроды гэтых парамэтраў, Rails не падзяляе іх і прадстаўляе аднолькавы да іх доступ&nbsp;&mdash; праз <a href="../rubyRef/index.html#Types_Hashes">Hash</a>-зьменную <code>params</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class ClientsController < ActionController::Base
          # Гэтая дзея выкарыстоўвае парамэтры першага віду, таму што праграма трапляе сюды
          # праз GET-запыт. Сэнс гэтай дзеі - прагледзець усіх актыўных/неактыўных кліентаў і URL
          # пры гэтым мог бы выглядаць наступным чынам: "/clients?status=activated"
          def index
            if params[:status] == "activated"
              @clients = Client.activated
            else
              @clients = Client.unactivated
            end
          end

          # Гэтая дзея выкарыстоўвае POST-парамэтры, каторыя хутчэй за ўсё прыйшлі
          # сюды з HTML-формы, каторую запоўніў карыстальнік. URL для гэтага
          # RESTful-запытў будзе выглядаць як "/clients", а даныя будуць дасланыя
          # як частка цела запыту.
          def create
            @client = Client.new(params[:client])
            if @client.save
              redirect_to @client
            else
              # Гэты радок перавызначае змоўчныя паводзіны адлюстраваньня, каторыя
              # інакш адлюстравалі б "create"-вью.
              render :action => "new"
            end
          end
        end
        ]]></script>

        <h3><a name="Controllers_Parameters_HashesAndArrays">Хэшы і масівы ў якасьці парамэтраў</a></h3>
        <p>У якасьці парамэтраў могуць быць ня толькі дыскрэтныя значэньні, але і <a href="../rubyRef/index.html#Types_Hashes">хэшы</a> ды <a href="../rubyRef/index.html#Types_Arrays">масівы</a>. Каб пазначыць, што ў якасьці парамэтру перадаецца масіў, трэба да імені парамэтру дадаць "<code>[]</code>":</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        GET /clients?ids[]=1&ids[]=2&ids[]=3
        ]]></script>
        <p>У папярэднім прыкладзе значэньне <code>params[:ids]</code> будзе масіў <code>["1", "2", "3"]</code>.</p>
        <p>Каб пазначыць, што парамэтар&nbsp;&mdash; хэш, трэба ў квадратных дужках пазначыць яшчэ імя ключа:</p>
        <script type="syntaxhighlighter" class="brush: html"><![CDATA[
        <form action="/clients" method="post">
          <input type="text" name="client[name]" value="Acme" />
          <input type="text" name="client[phone]" value="12345" />
          <input type="text" name="client[address][postcode]" value="12345" />
          <input type="text" name="client[address][city]" value="Carrot City" />
        </form>
        ]]></script>
        <p>Калі пазначаная форма будзе дасланая, значэньне <code>params[:client]</code> будзе <code>{"name" => "Acme", "phone" => "12345", "address" => {"postcode" => "12345", "city" => "Carrot City"}}</code>. Зьвярніце ўвагу на наяўнасьць у дадзеным прыкладзе укладзенага хэшу <code>params[:client][:address]</code>.</p>

        <h3><a name="Controllers_Parameters_Routing">Парамэтры разводкі</a></h3>
        <p>Хэш <code>params</code> акрамя іншага заўсёды будзе ўтрымліваць значэньні ключоў <code>:controller</code> і <code>:action</code>, пры гэтым пераважным спосабам атрыманьня адпаведных значэньняў зьяўляюцца мэтады <code>controller_name</code> і <code>action_name</code>. Іншыя парамэтры, якія вызначаюцца разводкай, як напрыклад <code>:id</code>, таксама будуць даступныя. Напрыклад, нам патрэбна вывадзіць сьпіс актыўных і неактыўных кліентаў, тады можна вызначыць разводку наступным чынам, уключыўшы ў яе статус кліента:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        map.connect "/clients/:status",
          :controller => "clients",
          :action => "index",
          :foo => "bar"
        ]]></script>
        <p>У гэтым выпадку, калі карыстальнік набірае ў адрасным радку <code>/clients/active</code>, значэньнем <code>params[:status]</code> будзе <code>"active"</code>. Адпаведна, калі спрацуе гэтая разводка, <code>params[:foo]</code> будзе ўтрымліваць значэньне <code>"bar"</code> (гэтак жа сама, калі б парамэтар быў перададзены як <i>query string parameter</i>).</p>

        <h3><a name="Controllers_Parameters_Default">Змоўчныя</a></h3>
        <p>У Rails маецца мэханізм, які дазваляе пазначыць парамэтры, каторыя будуць ужывацца пры кожным запыце да пэўнага ці да ўсіх кантролераў&nbsp;&mdash; пры дапамозе мэтаду <code>default_url_options</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class ApplicationController < ActionController::Base
          # Парамэтар options гэтага мэтаду будзе далей перададзены ў мэтад url_for
          def default_url_options(options)
            {:locale => I18n.locale}
          end
        end
        ]]></script>

        <h2><a name="Controllers_Cookies">Cookies</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html#cookies">Guide</a></li>
          </ul>
        </div>
        <p>Сеціўная праграма можа захоўваць невялікія аб&#8217;ёмы інфармацыі (да 4-ох кілябайтаў) на кліенцкім баку праз <i>cookie</i> браўзэраў, каторыя захоўваюцца пакуль ваша праграма ці сам карыстальнік ня выдаліць іх адтуль. Rails забяспечвае доступ да <i>cookie</i> праз мэтад <code>cookies</code>, праца зь якім, як і ў выпадку з <a href="#Security_Sessions"><code>session</code></a>, мае выгляд працы з хэшамі:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class CommentsController < ApplicationController
          def new
            # Auto-fill the commenter&#39;s name if it has been stored in a cookie
            @comment = Comment.new(:name => cookies[:commenter_name])
          end

          def create
            @comment = Comment.new(params[:comment])
            if @comment.save
              flash[:notice] = "Thanks for your comment!"
              if params[:remember_name]
                # Remember the commenter&#39;s name.
                cookies[:commenter_name] = @comment.name
              else
                # Delete cookie for the commenter&#39;s name cookie, if any.
                cookies.delete(:commenter_name)
              end
              redirect_to @comment.article
            else
              render :action => "new"
            end
          end
        end
        ]]></script>
        <p>У адрозьненьні ж ад працы з <a href="#Security_Sessions">сэсіямі</a>, каб выдаліць пэўнае значэньне з <i>cookie</i>, недастаткова пазначыць у якасьці новага значэньня <code>nil</code>, але трэба карыстацца выклікам кшталту <code>cookies.delete(:key)</code>.</p>

        <h2><a name="Controllers_Filters">Фільтры</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html#filters">Guide</a></li>
          </ul>
        </div>

        <h2><a name="Controllers_Verification">Спраўджаньне ўмоваў дзеі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html#verification">Guide</a></li>
          </ul>
        </div>



      </section>

      <section>
        <h1><a name="Security">Бясьпека</a></h1>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/security.html">Guide</a></li>
          </ul>
        </div>
        <p><a href="http://rubysource.com/techniques-to-secure-your-website-with-ruby-on-rails-part-1/?utm_medium=email&utm_campaign=RubySource+NL+June+12+2012&utm_content=RubySource+NL+June+12+2012+CID_f9e425d234de9486edbde880a89d6bd9&utm_source=Newsletter&utm_term=Secure+Your+Website+with+Ruby+on+Rails+Part+1">Techniques to Secure Your Website with Ruby On Rails (Part 1)</a></p>
        <p>Кожны фрэймворк распрацоўкі сеціўных праграм прадстаўляе распрацоўшчыку шэраг магчымасьцяў для ўмацаваньня бясьпекі ствараемай праграмы. Не выключэньне з гэтага правіла і Rails. Аднак, трэба заўважыць, што бясьпека праграмы не ўсталёўваецца і не падтрымліваецца ў належным стане сама па сабе. У любым выпадку апошняе залежыць ад распрацоўшчыкаў&nbsp;&mdash; як яны выкарыстоўваюць фрэймворк, а часам і ад тых мэтадаў, каторымі яны карыстаюцца пры распрацоўцы.</p>

        <h2><a name="Security_Sessions">Сэсіі</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://www.symantec.com/connect/articles/basic-web-session-impersonation">Symantec</a></li>
            <li><a href="http://www.technicalinfo.net/papers/WebBasedSessionManagement.html">TechnicalInfo.net</a></li>
            <li><a href="http://errtheblog.com/posts/22-sessions-n-such">Err The Blog</a></li>
          </ul>
        </div>
        <p>Па сваёй прыродзе <abbr class="term" title="HyperText Transfer Protocol">HTTP</abbr> не мае магчымасьці захоўваць стан&nbsp;&mdash; кожны новы запыт робіцца з &laquo;чыстага аркуша&raquo;. Гэта зусім не падыходзіць для зручнай працы сеціўных праграм, таму што пры пераходзе да новага адрасу праграмы (да новага <abbr class="term" title="Uniform Resource Locator">URL</abbr>&#8217;а) прыйшлося б штораз пытацца пра імя і пароль карыстальніка, каб ідэнтыфікаваць яго. Для вырашэньня гэтай праблемы быў уведзены мэханізм захаваньня сэсіі карыстальніка цягам усяго часу яго працы ў праграме. Праўда праграма можа ствараць штучныя абмежаваньні на працягласьць сэсій, каб паменшыць магчымыя дзіркі ў бясьпецы праграмы.</p>
        <aside><sup>3</sup> <a href="http://segment7.net/projects/ruby/drb/introduction.html">Уводзіны ў Distributed Ruby (DRb)</a>, <a href="http://code.google.com/p/rails-fast-sessions/">Запуск DRb-сэрвера ў якасьці Windows-сэрвісу.</a></aside>
        <p>Такім чынам, кожнаму карыстальніку праграмы пастаўлена ў адпаведнасьць сэсія&nbsp;&mdash; сукупнасьць хэша, каторы ўтрымлівае спэцыфічныя для сэсіі даныя, і ідэнтыфікатара сэсіі (звычайна 32-сымбальны выпадковы радок), па катораму шукаецца адпаведны хэш сэсіі. Ідэнтыфікатар сэсіі дасылаецца да браўзэра, каторы дасылае яго назад пры наступным запыце. Існуе некалькі спосабаў як абменьваццца ідэнтыфікатарам (праз адрасны радок, схаванае поле формы), але ўсе стандартныя мэханізмы захаваньня сэсіі ў Rails выкарыстоўваюць для гэтага <i>cookie</i>. Сярод згаданых вышэй мэханізмаў захаваньня сэсіі існуюць наступныя:
          <aside><sup>4</sup> <a href="http://memcached.org/">http://memcached.org</a></aside>
          <ul>
            <li><code class="class">CookieStore</code>&nbsp;&mdash; захоўвае даныя на баку кліента, таксама ў <i>cookie</i>, як і ўласна ідэнтыфікатар.</li>
            <li><code class="class">DRbStore</code>&nbsp;&mdash; захоўвае даныя ў <i>DRb</i>-сэрверы<sup>3</sup>.</li>
            <li><code class="class">MemCacheStore</code>&nbsp;&mdash; захоўвае даныя ў <i>memcached</i><sup>4</sup>.</li>
            <li><code class="class">ActiveRecordStore</code>&nbsp;&mdash; захоўвае даныя ў базе пасродкам <i>Active Record</i><sup>5</sup></li>
          </ul>
        </p>
        <aside><sup>5</sup> Гэты мэханізм зьяўляецца занадта марудным для кіраваньня сэсіямі праз архітэктурны прынцып <a href="http://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a>, які ўжываецца ў <i>Active Record</i>. Больш хуткія надбудовы ці аналягі: <a href="http://errtheblog.com/posts/22-sessions-n-such">SQLSessionStore</a> і <a href="http://code.google.com/p/rails-fast-sessions/">Fast Sessions</a></aside>
        <p>Усе пазначаныя мэханізмы акрамя першага захоўваюць даныя сэсіі на баку сэрвера (ці то ў табліцы базы, ці то ў памяці ці іншым якім чынам), і таму зьяўляюцца больш бясьпечнымі з таго пункту гледжаньня, што зламысьнік не можа падмяніць гэтыя даныя. Але і патрабуюць дадатковыя высілкі на наладжваньне. Змоўчны мэханізм (<code class="class">CookieStore</code>) не патрабуе ўвогуле ніякіх наладак і можа быць адразу ж выкарыстаны. Ён троху падгружае сеткавы трафік, таму што даныя сэсіі перадаюцца з кожным запытам, і, тэарэтычна, менш бясьпечны, таму што даныя сэсіі захоўваюцца на кліенцкім баку. Зламысьнік можа атрымаць да іх доступ, прачытаць і падмяніць. Але, па-першае, Rails прадухіляе магчымасьць падмяніць іх, праз крыптаграфічную подпіс. Па-другое, проста ня трэба захоўваць у сэсіі крытычную інфармацыю, неадпаведнае выкарыстаньне каторай можа падарваць бясьпеку праграмы. Акрамя гэтага існуе надбудова <a href="https://github.com/FooBarWidget/encrypted_cookie_store"><code class="class">EncryptedCookieStore</code></a>, каторая дадаткова да подпісу яшчэ і шыфруе ўвесь зьмест <i>cookie</i>.</p>
        <p>Пры выкарыстаньні любога з мэханізмаў захаваньня даных сэсіі (пры ўмове, што яны адпаведна наладжаны, акрамя <code class="class">CookieStore</code>, для якога не патрэбна дадатковая наладка) доступ да іх адбываецца даволі празрыста для распрацоўшчыка:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        # захоўваем у сэсіі ідэнтыфікатар карыстальніка
        session[:user_id] = @current_user.id

        # пазьней па гэтаму ідэнтыфікатару атрымліваем даныя карыстальніка з базы
        User.find(session[:user_id])

        # каб выдаліць нейкае значэньне з сэсіі, адпаведнаму ключу проста прысвойваецца nil
        @current_user = session[:user_id] = nil

        # а каб ачысьціць усю сэсію:
        reset_session
        ]]></script>

        <aside><sup>6</sup> Пры зьмене сакрэтнага ключу (атрымаць чарговы ключ можна праз каманду <code>rake secret</code>) усе ранейшыя сэсіі стануць несапраўднымі.</aside>
        <h3><a name="Security_Sessions_Settings">Наладжваньне</a></h3>
        <p>Як наладжваць кожны з мэханізмаў захаваньня даных сэсій глядзіце <a href="http://errtheblog.com/posts/22-sessions-n-such">Err The Blog</a>. Тут жа пазначым толькі агульныя асаблівасьці ды тыя зь іх, якія тычацца <code class="class">CookieStore</code>, як больш пажаданага мэханізму.</p>
        <p>Які мэханізм ужываць, а таксама ключ сэсіі (імя <i>cookie</i>), каторы выкарыстоўваецца пры подпісе даных сэсіі, пазначаецца ў файле <code>config/initializers/session_store.rb</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        _YourApp_::Application.config.session_store :cookie_store, :key => '_your_app_session'
        ]]></script>
        <p>Сакрэтны ключ, каторы таксама ўжываецца пры подпісе даных, пазначаецца ў файле <code>config/initializers/secret_token.rb</code><sup>6</sup></p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        YourApp::Application.config.secret_token = '49d3f3de9ed86c74b94ad6bd0...'
        ]]></script>

        <h3><a name="Security_Sessions_TurnOff">Ігнараваньне</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://errtheblog.com/posts/22-sessions-n-such">Err The Blog</a></li>
            <li><a href="http://gurge.com/blog/2007/01/08/turn-off-rails-sessions-for-robots/">gurge.com</a></li>
          </ul>
        </div>
        <p>Па змоўчаньні кожны запыт да праграмы суправаджаецца інфармацыяй пра сэсію. Натуральна гэта не заўсёды патрэбна, а ў выпадку, калі запыт прыйшоў ад сеціўнага робата, нават шкодна&nbsp;&mdash; у сэнсе дадатковай непатрэбнай і інтэнсіўнай загрузкі праграмы, асабліва калі сэсія захоўваецца ў базе.</p>
        <p>Каб праграма ігнаравала запыты ботаў пры кіраваньні сэсіямі, трэба спачатку мець мэтад, каторы будзе вызначаць ці гэта бот:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class Util
          def self.is_bot?(user_agent)
            user_agent =~ /\b(Baidu|Gigabot|Googlebot|libwww-perl|lwp-trivial|msnbot|SiteUptime|Slurp|WordPress|ZIBB|ZyBorg)\b/i
          end
        end
        ]]></script>
        <p>Пасьля гэтага адключаем для іх апрацоўку сэсій:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class ApplicationController < ActionController::Base
          # адключаем апрацоўку сэсій, калі запыт прыйшоў ад бота
          session :off, :if => proc { |request| Util.is_bot?(request.user_agent) }

          ...
        end
        ]]></script>

        <h3><a name="Security_Sessions_Flashes">Бліскаўкі</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html#the-flash">Guide</a></li>
          </ul>
        </div>
        <p>Хаця й не маюць непасрэдны ўплыў на бясьпеку праграмы, але зьяўляюцца неад&#8217;емнай часткай сэсій так званыя бліскаўкі (ад ангельскага <i>flash</i>)&nbsp;&mdash; паведамленьні (інфармацыйныя, папярэджваючыя ці аб памылках), час жыцьця каторых&nbsp;&mdash; выключна наступны запыт. Адсюль і назва. Праца зь імі падобна да працы з сэсіямі. Разгледзем прыклад выхаду карыстальніка з праграмы. Адпаведны кантролер можа пазначыць якое паведамленьне паказаць карыстальніку наступным крокам:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class LoginsController < ApplicationController
          def destroy
            session[:current_user_id] = nil
            flash[:notice] = "Вы пасьпяхова выйшлі з праграмы"
            redirect_to root_url
          end
        end
        ]]></script>
        <p>Тое ж самае можна зрабіць троху іншым чынам&nbsp;&mdash; праз само перанакіраваньне:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        redirect_to root_url, :notice => "Вы пасьпяхова выйшлі з праграмы"
        ]]></script>
        <p>Дзея <code class="method">destroy</code> кантролеру <code class="class">LoginsController</code> перанакіроўвае да адрасу <code>root_url</code>, дзе пазначанае паведамленьне павінна быць адлюстравана. Аднак, што рабіць і ўвогуле ці рабіць нешта з гэтым паведамленьнем, залежыць ад кантролера (вью), адказнага за наступны запыт. Павялося, што бліскаўкі адлюстроўваюцца ў <a href="#Views_LayoutsRendering">макетах</a> праграмы:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        <html>
          <!-- <head/> -->
          <body>
            <% if flash[:notice] %>
              <p class="notice"><%= flash[:notice] %></p>
            <% end %>
            <% if flash[:error] %>
              <p class="error"><%= flash[:error] %></p>
            <% end %>
            <!-- more content -->
          </body>
        </html>
        ]]></script>
        <p>Пры такім падыходзе бліскаўкі, пазначаныя папярэднімі дзеямі, будуць аўтаматычна адлюстроўвацца макетамі. У адваротным выпадку імі нічога ня будзе адлюстравана.</p>
        <p>Пры неабходнасьці перадаць тыя ж бліскаўкі наступнаму запыту можна скарыстацца мэтадам <code class="method">keep</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class MainController < ApplicationController
          # Напрыклад гэтая дзея адпавядае адрасу root_url, і вы жадаеце, каб
          # усе запыты адсюль былі перанакіраваны ў UsersController#index.
          # Калі папярэдняя дзея пазначала пэўныя бліскаўскі, яны ўжо будуць
          # недаступныя ў UsersController#index. Але іх можна 'перадаць' туды.
          def index
            # Перадасьць усе бліскаўкі наступнай дзеі.
            flash.keep

            # Калі перадаць трэба толькі пэўную бліскаўку, гэта можна зрабіць такім чынам:
            # flash.keep(:notice)
            redirect_to users_url
          end
        end
        ]]></script>

        <h4><a name="Security_Sessions_Flashes_Now"><code class="method">flash.now</code></a></h4>
        <p>Часам нейкае паведамленьне трэба адлюстраваць у межах таго ж самага запыту, без перанакіраваньня. Напрыклад, калі пэўная дзея пры памылцы дасылае да іншай дзеі таго ж кантролеру. У гэтым выпадку звычайнымі бліскаўкамі скарыстацца няма магчымасьці, таму што доступ ёсьць толькі да паведамленьняў з папярэдняга запыту. Тады трэба карыстацца <code class="method">flash.now</code>:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        class ClientsController < ApplicationController
          def create
            @client = Client.new(params[:client])
            if @client.save
              # ...
            else
              flash.now[:error] = "Could not save client"
              render :action => "new"
            end
          end
        end
        ]]></script>

        <h2><a name="Security_Authentication">Ідэнтыфікацыя карыстальніка</a></h2>
        <!--div class="refs">
          <ul>
            <li><a href="http://www.symantec.com/connect/articles/basic-web-session-impersonation">Symantec</a></li>
            <li><a href="http://www.technicalinfo.net/papers/WebBasedSessionManagement.html">TechnicalInfo.net</a></li>
            <li><a href="http://errtheblog.com/posts/22-sessions-n-such">Err The Blog</a></li>
          </ul>
        </div-->
        <p>authlogic: <a href="https://github.com/binarylogic/authlogic">https://github.com/binarylogic/authlogic</a>,
          <a href="https://github.com/binarylogic/authlogic_example">https://github.com/binarylogic/authlogic_example</a>,
          <a href="http://agilewebdevelopment.com/plugins/authgasm">http://agilewebdevelopment.com/plugins/authgasm</a>,
          <a href="http://www.logansbailey.com/2010/10/06/how-to-setup-authlogic-in-rails-3/">http://www.logansbailey.com/2010/10/06/how-to-setup-authlogic-in-rails-3</a>,
          <a href="http://www.dixis.com/?p=352">http://www.dixis.com/?p=352</a>,
          <a href="http://stackoverflow.com/questions/3508494/configuring-username-format-in-authlogic">http://stackoverflow.com/questions/3508494/configuring-username-format-in-authlogic</a>,
          <a href="http://stackoverflow.com/questions/2615372/configuring-authlogic-oauth-with-google">http://stackoverflow.com/questions/2615372/configuring-authlogic-oauth-with-google</a>,
          <a href="http://stackoverflow.com/questions/3454248/configure-authlogic-to-log-in-with-username-or-email">http://stackoverflow.com/questions/3454248/configure-authlogic-to-log-in-with-username-or-email</a>
        </p>

        <p>Ruby OAuth: <a href="https://github.com/oauth/oauth-ruby">https://github.com/oauth/oauth-ruby</a></p>

        <p>devise: <a href="https://github.com/plataformatec/devise">https://github.com/plataformatec/devise</a>,
          <a href="https://github.com/plataformatec/devise/wiki">https://github.com/plataformatec/devise/wiki</a>,
          <a href="http://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/">http://www.tonyamoyal.com/2010/07/28/rails-authentication-with-devise-and-cancan-customizing-devise-controllers/</a>
        </p>

        <h2><a name="Security_Authorization">Аўтарызацыя</a></h2>
        <p>CanCan: <a href="https://github.com/ryanb/cancan">https://github.com/ryanb/cancan</a></p>

        <h2><a name="Security_RequestForgery">Падробка запытаў</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/security.html#cross-site-request-forgery-csrf">Guide</a></li>
          </ul>
        </div>

        <h3><a name="Security_RequestForgery_Protection">Абарона</a></h3>
        <div class="refs">
          <ul>
            <li><a href="http://guides.rubyonrails.org/action_controller_overview.html#request-forgery-protection">Guide</a></li>
          </ul>
        </div>

        <h2><a name="Security_SSL">Бясьпечная перадача даных</a></h2>
        <p><a href="http://devcenter.heroku.com/articles/ssl">SSL on Heroku</a></p>
        <p><a href="http://stackoverflow.com/questions/3634100/rails-3-ssl-deprecation">Rails 3 SSL Deprecation</a></p>
        <p><a href="http://stackoverflow.com/questions/3993651/rails-3-ssl-routing-redirects-from-https-to-http">Rails 3 SSL routing redirects from https to http</a></p>
        <p><a href="http://stackoverflow.com/questions/4771743/how-do-i-force-an-ssl-connection-with-rails-3-but-only-when-a-user-is-logged-in">How do I force an SSL connection with Rails 3, but only when a user is logged in?</a></p>
        <p>Rails redirect with HTTPS: <a href="http://stackoverflow.com/questions/1662262/rails-redirect-with-https">http://stackoverflow.com/questions/1662262/rails-redirect-with-https</a></p>
        <p>Using SSL in Rails Applications: <a href="http://www.buildingwebapps.com/articles/79189-using-ssl-in-rails-applications">http://www.buildingwebapps.com/articles/79189-using-ssl-in-rails-applications</a></p>
        <p>Rails and SSL: <a href="http://siannopollo.blogspot.com/2007/08/rails-and-ssl-https.html">http://siannopollo.blogspot.com/2007/08/rails-and-ssl-https.html</a></p>
        <p>ssl_requirement: <a href="https://github.com/retr0h/ssl_requirement">https://github.com/retr0h/ssl_requirement</a>, <a href="http://rubygems.org/gems/ssl_requirement">http://rubygems.org/gems/ssl_requirement</a></p>

        <h3><a name="Security_SSL_ConfiguringWEBrick">Наладка SSL для WEBrick</a></h3>
        <p>Па змоўчаньні стандартны вэб-сэрвер распрацоўшчыцкага асяродку (<a href="http://oldwiki.rubyonrails.org/rails/pages/WEBrick"><i>WEBrick</i></a>) апрацоўвае толькі <i>http</i>-запыты. Каб &laquo;прымусіць&raquo; яго апрацоўваць і <i>https</i>-запыты, патрабуецца прыкласьці трохі высілкаў.</p>

        <h4><a name="Security_SSL_ConfiguringWEBrick_Certificate">Генерацыя сэртыфікату</a></h4>
        <div class="refs">
          <ul>
            <li><a href="http://www.parorrey.com/blog/webmaster-tasks/configuring-webrick-to-serve-redmine-over-ssl-using-openssl-certificate/">parorrey.com</a></li>
          </ul>
        </div>
        <p>Першым крокам трэба стварыць сэртыфікат, каторы будзе ўжывацца для шыфраванай перадачы даных. Зробім гэта пры дапамозе бясплатнай прылады <a href="http://www.openssl.org/"><i>OpenSSL</i></a>. Яна, дарэчы, ідзе ў пастаўцы <a href="../gitRef/index.html">Git</a>. Таму, калі ў вас ужо ўсталяваны апошні, вы знойдзеце <code>openssl.exe</code> у яго <code>bin</code> тэчцы. Выконваем наступную каманду для стварэньня <i>Request</i>-сэртыфікату і адпаведнага прыватнага ключу:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ openssl req -new > server.cert.csr
        ]]></script>
        <p>У працэсе выкананьня будзе заданы шэраг абавязковых (напр. пароль) і неабавязковых (калі вы не жадаеце ўводзіць пэўныя даныя, пастаўце кропку) пытаньняў:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        [root@pm ]# openssl req -new > server.cert.csr
        Generating a 1024 bit RSA private key
        ...++++++
        ..................................................++++++
        writing new private key to 'privkey.pem'
        Enter PEM pass phrase:
        Verifying - Enter PEM pass phrase:
        -----
        You are about to be asked to enter information that will be incorporated
        into your certificate request.
        What you are about to enter is what is called a Distinguished Name or a DN.
        There are quite a few fields but you can leave some blank
        For some fields there will be a default value,
        If you enter '.', the field will be left blank.
        -----
        Country Name (2 letter code) [GB]:GB
        State or Province Name (full name) [Berkshire]:Berkshire
        Locality Name (eg, city) [Newbury]:Newbury
        Organization Name (eg, company) [My Company Ltd]:My Co Ltd
        Organizational Unit Name (eg, section) []:.
        Common Name (eg, your name or your servers hostname) []:test.com
        Email Address []:test@test.com

        Please enter the following 'extra' attributes
        to be sent with your certificate request
        A challenge password []:my_password
        An optional company name []:.
        ]]></script>
        <p>У выніку будуць створаны 2 файлы: <code>server.cert.csr</code> (<i>Request</i>-сэртыфікат) і <code>privkey.pem</code> (прыватны ключ). Вымем зараз ключ для подпісу сэртыфікату (інакш прыйшлося б уводзіць пароль пры ўсталяваньні <i>https</i>-злучэньня):</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ openssl rsa -in privkey.pem -out server.cert.key
        Enter pass phrase for privkey.pem:
        writing RSA key
        ]]></script>
        <p>Гэта створыць файл <code>server.cert.key</code>. Зараз трансфармуем <i>Request</i>-сэртыфікат у падпісаны сэртыфікат:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ openssl x509 -in server.cert.csr -out server.cert.crt -req -signkey server.cert.key -days 365
        Signature ok
        subject=/C=GB/ST=Berkshire/L=Newbury/O=My CO Ltd/CN=test.com/emailAddress=test@test.com
        Getting Private key
        ]]></script>
        <p>У выніку атрымаем файл падпісанага сэртыфікату <code>server.cert.crt</code>.</p>

        <h4><a name="Security_SSL_ConfiguringWEBrick_ActivatingSSL">Актывацыя SSL у WEBrick</a></h4>
        <div class="refs">
          <ul>
            <li><a href="http://www.nearinfinity.com/blogs/chris_rohr/configuring_webrick_to_use_ssl.htm/">nearinfinity.com</a></li>
          </ul>
        </div>
        <p>Зараз створым тэчку <code>cert</code> у карнявой тэчцы адпаведнай Rails-праграмы і перапішам туды файлы <code>server.cert.crt</code> і <code>server.cert.key</code>. Пасьля гэтага трэба зрабіць копію файла <code>rails</code> у тэчцы <code>script</code>, назавем яго <code>rails_ssl</code>. Адкрыем яго і ўставім перад аб&#8217;яўленьнем пераменнай <code>APP_PATH</code> наступныя радкі:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
        require 'rubygems'
        require 'rails/commands/server'
        require 'rack'
        require 'webrick'
        require 'webrick/https'

        module Rails
          class Server < ::Rack::Server
            def default_options
              super.merge({
                :Port => 3001,
                :environment => (ENV['RAILS_ENV'] || "development").dup,
                :daemonize => false,
                :debugger => false,
                :pid => File.expand_path("tmp/pids/server.pid"),
                :config => File.expand_path("config.ru"),
                :SSLEnable => true,
                :SSLVerifyClient => OpenSSL::SSL::VERIFY_NONE,
                :SSLPrivateKey => OpenSSL::PKey::RSA.new(
                       File.open("/path/to/key").read),
                :SSLCertificate => OpenSSL::X509::Certificate.new(
                       File.open("/path/to/crt").read),
                :SSLCertName => [["CN", WEBrick::Utils::getservername]]
              })
            end
          end
        end
        ]]></script>
        <p>Зьвярніце ўвагу на наступныя акалічнасьці. Пе-першае, мы абралі порт (<code>:Port => 3001</code>), які адрозьніваецца ад стандартнага <i>https</i>-порту (443), таму што апошні па змоўчаньні блякуецца файрволам <i>Windows</i>, а ў распрацоўшчыцкім асяродку няма вялікай розніцы які порт абраць. Таксама порт павінен адрозьнівацца ад стандартнага порту <i>WEBrick</i> у Rails (3000), таму што, калі мы жадаем, каб працавалі і <i>http</i>-запыты, і <i>https</i>-запыты, нам трэба будзе запускаць 2 экзэмпляры <i>WEBrick</i>&nbsp;&mdash; адзін для апрацоўкі <i>http</i>-запытаў, іншы для апрацоўкі <i>https</i>-запытаў. Гэта можа ня вельмі зграбнае рашэньне праблемы, але даволі простае, таму заплюшчым на гэта вочы. Па-другое, у прыкладзе пазначаныя фіктыўныя шляхі да файлаў сэртыфікату і ключа (<code>/path/to/crt</code> і <code>/path/to/key</code>). Вам трэба будзе зьмяніць іх на сапраўдныя, кшталту <code>d:/projects/abc/cert/server.cert.key</code>. Вуаля! Цяпер трэба ў адным кансольным акне запусьціць сэрвер для <i>http</i>:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ script/rails server
        ]]></script>
        <p>а ў іншым кансольным акне&nbsp;&mdash; сэрвер для <i>https</i>:</p>
        <script type="syntaxhighlighter" class="brush: text"><![CDATA[
        $ script/rails_ssl server
        ]]></script>

      </section>

      <section>
        <h1><a name="Mailer">Пошта</a></h1>
        <div class="refs">
          <ul>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/actionmailer_id326030.html">in a Nutshell</a></li>
          </ul>
        </div>
        <p>Дастаўка электронных лістоў у Rails на аснове шаблёнаў робіцца вельмі падобна на візуалізацыю HTML/ERB вью. Акрамя гэтага кампанэнт Action Mailer дазваляе адказваць на ўваходныя лісты, пераўтвараць уваходныя лісты ў камэнтары на HTML-старонках і іншае.</p>

      </section>

      <section>
        <h1><a name="WebServices">Вэб-сэрвісы</a></h1>
        <div class="refs">
          <ul>
            <li><a href="http://ofps.oreilly.com/titles/9780596521424/activeresource_id59243.html">in a Nutshell</a></li>
          </ul>
        </div>
        <p>Active Resource дазваляе выкарыстоўваць зьнешні RESTful-API нібы лякальныя рэсурсы (мадэлі) праграмы.</p>

      </section>

      <section>
        <h1><a name="RSS">RSS</a></h1>
        <p>Каб дадаць у праграму магчымасьць адказваць на запыты RSS-чытальнікаў, дастаткова ў дзею кантролера дадаць яшчэ адзін, адпаведны фармат вью (радок 7):</p>
        <script type="syntaxhighlighter" class="brush: ruby; highlight: [7]"><![CDATA[
          def index
            @videos = Video.all

            respond_to do |format|
              format.html # index.html.erb
              format.json { render :json => @videos }
              format.atom
            end
          end
        ]]></script>
        <p>У якасьці шаблёну можна было б стварыць <code>index.atom.erb</code> і скарыстацца магчымасьцямі ERB для генэрацыі вью. Але Rails мае начыньне, якое больш пасуе для стварэньня XML-дакумэнтаў, якімі зьяўляюцца дакумэнты для RSS-чытальнікаў&nbsp;&mdash; гэта Builder-шаблёны (<code>index.atom.builder</code>):</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          atom_feed do |feed|
            feed.title("Awesome Videos")
            feed.updated(@videos.first.created_at)

            @videos.each do |video|
              feed.entry(video) do |entry|
                entry.title(video.title)
                entry.content(sanitize_embeded(video), :type => 'html')

                entry.author do |author|
                  author.name("Some cool author name")
                end
              end
            end
          end
        ]]></script>
        <p>Акрамя стварэньня магчымасьці адказваць на наўпроставыя RSS-запыты, можна ў звычайную HTML-старонку дадаць дадатковы тэг, каб браўзэры самі маглі вымаць інфармацыю пра RSS. Для гэтага ў целе тэгу <code>&lt;head&gt;</code> трэба ўставіць наступнае:</p>
        <script type="syntaxhighlighter" class="brush: html"><![CDATA[
          <link href="/videos.atom" rel="alternate" title="ATOM" type="application/atom+xml" />
        ]]></script>
        <p>Альбо тое ж самае пры дапамозе Rails-дапаможніку:</p>
        <script type="syntaxhighlighter" class="brush: ruby"><![CDATA[
          <%= auto_discovery_link_tag :atom, videos_path(:atom) %>
        ]]></script>
      </section>

      <section>
        <h1><a name="Optimization">Аптымізацыя</a></h1>
        <p><a href="https://devcenter.heroku.com/articles/http-caching-ruby-rails?utm_medium=email&utm_campaign=October+2012+Newsletter&utm_content=October+2012+Newsletter+CID_57270a88281760fc540ac59ffb6c8a66&utm_source=Email%20Blast&utm_term=This%20article%20by%20Vincent%20Spehner">HTTP Caching in Ruby with Rails</a></p>

        <h2><a name="Optimization_Scalability">Маштабіруемасьць</a></h2>
        <div class="refs">
          <ul>
            <li><a href="http://railslab.newrelic.com/scaling-rails">Casts на newrelic.com</a></li>
          </ul>
        </div>


      </section>

      <section>
        <h1><a name="Money">Money in Rails</a></h1>
        <p>Money values:
          <ul>
            <li><a href="https://github.com/RubyMoney/money">money-library</a></li>
            <li><a href="http://blog.clickablebliss.com/2006/06/14/using-aggregation-in-rails-to-manage-money/">Using aggregation in Rails to manage money</a></li>
          </ul>
        </p>

        <h1><a name="Payment">Плацежныя сыстэмы ў Rails</a></h1>
        <p><a href="http://activemerchant.org/" title="ActiveMerchant">ActiveMerchant&nbsp;&mdash; дадатак і <i>gem</i></a>.</p>
        <p><a href="http://habrahabr.ru/company/skydns/blog/124058/">Enlarge your payment, или паранойя платежных систем</a>.</p>
      </section>
      <section>
        <h1><a name="JS">Інтэграцыя з JavaScript</a></h1>
        <p>Праблема выкарыстаньня jQuery у Rails. Канфлікты з іншымі фрэймворкамі і шляхі іх разьвязваньня:
          <ul>
            <li><a href="http://errtheblog.com/posts/73-the-jskinny-on-jquery">The jSkinny on jQuery</a></li>
            <li><a href="http://www.alfajango.com/blog/rails-prototype-to-jquery/">Rails, Prototype, and JQuery in Harmony (or how to replace Prototype with JQuery)</a></li>
            <li><a href="http://railscasts.com/episodes/136-jquery">jQuery Railscast</a></li>
            <li><a href="http://railstips.org/blog/archives/2008/11/20/jquery-on-rails-why-bother/">jQuery on Rails: Why Bother?</a></li>
            <li><a href="https://github.com/indirect/jquery-rails">jquery-rails gem</a></li>
          </ul>
        </p>
        <p>RJS, jQuery, Rails:
          <ul>
            <li><a href="http://www.rubyinside.com/16-rjs-resources-and-tutorials-for-rails-programmers-5.html">16 RJS Resources and Tutorials for Rails Programmers (2006 - useful?)</a></li>
            <li><a href="http://slash7.com/assets/2006/10/8/RJS-Demistified_Amy-Hoy-slash7_1.pdf">RJS demistified (PDF cheat-sheet)</a></li>
            <li><a href="http://railscasts.com/episodes/45-rjs-tips">RJS tips Railscast</a></li>
            <li><a href="http://api.rubyonrails.org/classes/ActionView/Helpers/PrototypeHelper/JavaScriptGenerator/GeneratorMethods.html">ActionView::Helpers::PrototypeHelper::JavaScriptGenerator::GeneratorMethods</a></li>
            <li><a href="http://stackoverflow.com/questions/906634/running-a-rails-rjs-template-from-a-jquery-get-request">Running a rails RJS template from a jquery get request</a></li>
          </ul>
        </p>
        <p>AJAX:
          <ul>
            <li><a href="http://net.tutsplus.com/tutorials/javascript-ajax/using-unobtrusive-javascript-and-ajax-with-rails-3/">Using Unobtrusive JavaScript and AJAX with Rails 3</a></li>
          </ul>
        </p>
        <p><a href="http://www.alfajango.com/blog/rails-3-remote-links-and-forms-data-type-with-jquery/">Rails3: remote links and forms data type with jQuery</a></p>
        <p><a href="http://www.alfajango.com/blog/rails-jquery-ujs-now-interactive/">Rails jquery-ujs now interactive</a></p>
        <p><a href="http://stackoverflow.com/questions/4421072/jquery-ui-dialog-instead-of-alert-for-rails-3-data-confirm-attribute">jQuery-UI dialog instead of alert for Rails3 data-confirm attribute</a></p>
        <p><a href="http://www.simonecarletti.com/blog/2010/06/unobtrusive-javascript-in-rails-3/">Unobtrusive javascript in Rails3</a></p>
        <p><a href="http://www.stjhimy.com/posts/7-creating-a-100-ajax-crud-using-rails-3-and-unobtrusive-javascript">AJAX CRUD using Rails3 and unobtrusive JavaScript.</a></p>
      </section>

      <footer>
        <div id="powered">
          <h5>Падзякі</h5>
          <p>Пры састаўленьні даведніка выкарыстоўваліся наступныя скрыпты, за якія аўтар выказвае свае падзякі іх аўтарам:
            <ul>
              <li><a href="http://jquery.com/">jQuery</a>&nbsp;&mdash; унівэрсальная JavaScript-бібліятэка</li>
              <li><a href="http://xregexp.com/">XRegExp</a>&nbsp;&mdash; JavaScript-бібліятэка для рэгулярных выразаў (regexp)</li>
              <li><a href="http://www.mattkruse.com/javascript/mktree/">DHTML Tree</a>&nbsp;&mdash; скрыпт для пабудовы герархічнага дрэва разьдзелаў даведніка злева.</li>
              <li><a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>&nbsp;&mdash; скрыпт для каляроўкі фрагмэнтаў коду пэўных моваў/скрыптоў.</li>
            </ul>
          </p>
        </div>
        <div id="copyright">
          <p>Copyright &copy; 2010-2011 <a href="http://www.yurtsevich.info">yurtsevich.info</a></p>
          <p>
            <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.be">
              <img src="http://i.creativecommons.org/l/by-nc/3.0/88x31.png"
                  style="border-style: none;" alt="Common Creatives. Attribution + Noncommercial (by-nc)" />
            </a>
          </p>
          <p><cite>Тэхнічны даведнік па Rails</cite> публікуецца пад ліцэнзіяй <cite>Commons Creative Attribution-NonCommercial 3.0 Unported (CC BY-NC 3.0)</cite>. Вы вольны ў тым, як выкарыстоўваць гэтую працу, у тым ліку капіяваць, распаўсюджваць і зьмяняць яе на свой капыл. Але <strong>толькі ў некамэрцыйных мэтах</strong> і <strong>абавязкова з пазнакай <a href="http://www.yurtsevich.info/refs/railsRef/index.html">крыніцы</a></strong> матэрыялу.</p>
        </div>
      </footer>
    </article>
  </div> <!--! end of #container -->


  <!-- Javascript at the bottom for fast page loading -->

  <!-- GetSatisfaction feedback button BEGIN -->
  <script type="text/javascript" charset="utf-8">
    var is_ssl = ("https:" == document.location.protocol);
    var asset_host = is_ssl ? "https://s3.amazonaws.com/getsatisfaction.com/" : "http://s3.amazonaws.com/getsatisfaction.com/";
    document.write(unescape("%3Cscript src='" + asset_host + "javascripts/feedback-v2.js' type='text/javascript'%3E%3C/script%3E"));
  </script>

  <script type="text/javascript" charset="utf-8">
    var feedback_widget_options = {};

    feedback_widget_options.display = "overlay";
    feedback_widget_options.company = "yurtsevich";
    feedback_widget_options.placement = "right";
    feedback_widget_options.color = "#222";
    feedback_widget_options.style = "problem";

    var feedback_widget = new GSFN.feedback_widget(feedback_widget_options);
  </script>
  <!-- GetSatisfaction feedback button END -->

  <!-- Grab Google CDN's jQuery. fall back to local if necessary -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="../js/libs/jquery-1.7.1.min.js"%3E%3C/script%3E'))</script>

  <script src="../js/libs/jquery.tree.js"></script>

  <script src="../js/libs/waypoints.min.js"></script>
  <script src="../js/ref.js"></script>

  <script src="../js/libs/xregexp.js"></script>
  <script src="../js/libs/shCore.js"></script>
  <script src="../js/libs/shAutoloader.js"></script>
  <script type="text/javascript">
    function path()
    {
      var args = arguments,
          result = []
          ;

      for(var i = 0; i < args.length; i++)
          result.push(args[i].replace('@', '../js/libs/'));

      return result
    };

    SyntaxHighlighter.autoloader.apply(null, path(
      'applescript            @shBrushAppleScript.js',
      'actionscript3 as3      @shBrushAS3.js',
      'bash shell             @shBrushBash.js',
      'coldfusion cf          @shBrushColdFusion.js',
      'cpp c                  @shBrushCpp.js',
      'c# c-sharp csharp      @shBrushCSharp.js',
      'css                    @shBrushCss.js',
      'delphi pascal          @shBrushDelphi.js',
      'diff patch pas         @shBrushDiff.js',
      'erl erlang             @shBrushErlang.js',
      'groovy                 @shBrushGroovy.js',
      'java                   @shBrushJava.js',
      'jfx javafx             @shBrushJavaFX.js',
      'js jscript javascript  @shBrushJScript.js',
      'perl pl                @shBrushPerl.js',
      'php                    @shBrushPhp.js',
      'text plain             @shBrushPlain.js',
      'py python              @shBrushPython.js',
      'ruby rails ror rb      @shBrushRuby.js',
      'sass scss              @shBrushSass.js',
      'scala                  @shBrushScala.js',
      'sql                    @shBrushSql.js',
      'vb vbnet               @shBrushVb.js',
      'xml xhtml xslt html    @shBrushXml.js'
    ));

    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.all();
  </script>

  <!-- asynchronous google analytics: mathiasbynens.be/notes/async-analytics-snippet
       change the UA-XXXXX-X to be your site's ID -->
  <script>
   var _gaq = [['_setAccount', 'UA-18077954-1'], ['_trackPageview']];
   (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
   })(document, 'script');
  </script>

  <script src="http://static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">clicky.init(17136);</script>
</body>
</html>