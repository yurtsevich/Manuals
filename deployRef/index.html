<!doctype html>

<html lang="be-tarask" class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Разгортваньне праграм у працоўным асяродку</title>
  <meta name="description" content="Разгортваньне праграм у працоўным асяродку">
  <meta name="author" content="Юрцэвіч Дзьмітры">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="../css/boilerplate.css?v=2">
  <link rel="stylesheet" href="../css/screen.css?v=1">
  <link rel="stylesheet" href="../css/prism.css">
</head>

<body>
  <div id="container">
    <article id="content">
      <header>
        Разгортваньне праграм у працоўным асяродку
      </header>

      <section>
        <h1 id="OpenShift" data-content-item-open>OpenShift</h1>
        <div class="refs">
          <ul>
            <li><a href="https://www.openshift.com/">Home</a></li>
            <li><a href="https://openshift.redhat.com/app/console">Web console</a></li>
          </ul>
        </div>
        <p><a href="http://www.first8.nl/blog/vertical-scaling-with-openshift/">VERTICAL SCALING WITH OPENSHIFT</a>.</p>
        <p><a href="http://www.first8.nl/blog/horizontal-scaling-with-open-shift/">HORIZONTAL SCALING WITH OPENSHIFT</a>.</p>
        <p><a href="http://www.first8.nl/blog/managing-multiple-gears-with-open-shift/">MANAGING MULTIPLE GEARS WITH OPEN SHIFT</a>.</p>

        <p><i>OpenShift</i>&nbsp;&ndash; <i>The Open Hybrid Cloud Application Platform by Red Hat</i>, іншымі словамі <i>PaaS</i> для аўтаматычнага разгортваньня праграм на воблачным хостынгу.</p>
        <p>Падтрымлівае мовы:</p>
        <ul>
          <li><i>Java</i> (<i>JBoss AS 7</i>, <i>WildFly 8.2</i>, <i>Tomcat 6/7 via JBoss EWS</i>, <i>JBoss EAP 6.4</i>)</li>
          <li><i>Ruby</i></li>
          <li><i>Node.js</i></li>
          <li><i>Python</i></li>
          <li><i>Perl</i></li>
          <li><i>PHP</i></li>
          <li><i>Ceylon</i></li>
          <li><i>DIY/Custom</i></li>
        </ul>

        <h2 id="OpenShift_ClientTools">Client tools</h2>
        <div class="refs">
          <ul>
            <li><a href="https://developers.openshift.com/en/getting-started-debian-ubuntu.html">Install</a></li>
            <li><a href="https://access.redhat.com/documentation/en-US/OpenShift_Online/2.0/html-single/User_Guide/index.html">Guide</a></li>
          </ul>
        </div>
        <p>Акрамя <a href="https://openshift.redhat.com/app/console">вэб-кансолі</a> кіраваць праграмай можна праз <i>client tools</i> (<i>rhc</i>)&nbsp;&ndash; кансольную праграму, якая працуе на <i>Ruby</i>.</p>

        <h2 id="OpenShift_CreateApp">Ствараем праграму</h2>

<pre><code class="language-bash">
$ rhc app-create myapp wildfly
</code></pre>

        <p>Будзе створана загатоўка <i>JEE</i>-праграмы для працы з сэрвэрам <i>WildFly</i> наступнай структуры:</p>
<pre>
|-- deployments/       Location for built WARs
|-- src/               Maven source structure
|-- pom.xml            Maven build file
`-- .openshift/        Location for OpenShift specific files
   |-- config/         Location for configuration files such as standalone.xml
   |-- action_hooks/   See the Action Hooks documentation 
   `-- markers/        See the Markers documentation 
</pre>
        <p>Дадаем <i>PostgreSQL</i>:</p>

<pre><code class="language-bash">
$ rhc cartridge add postgresql-9.2 -a myapp
</code></pre>

        <p>Адлеглыя <i>WildFly</i> і <i>PostgreSQL</i> будуць цалкам наладжаныя на працу. Застаецца наладзіць лякальныя <i>WildFly</i> і <i>PostgreSQL</i>.</p>

        <h2 id="OpenShift_LocalConfig">Наладжваем лякальны асяродак</h2>
        <div class="refs">
          <ul>
            <li><a href="http://www.mastertheboss.com/jboss-server/jboss-datasource/configuring-a-datasource-with-postgresql-and-jboss-wildfly">Link 1</a></li>
            <li><a href="http://www.quizful.net/post/datasource-in-wildfly-jboss-using-postgresql">Link 2</a></li>
            <li><a href="http://devcolibri.com/4661">Link 3</a></li>
          </ul>
        </div>
        <p><a href="https://jdbc.postgresql.org/download.html">Запампоўваем</a> <i>JDBC</i>-драйвэр для <i>PostgreSQL</i> той вэрсіі, якая лякальна ўсталяваная (няхай гэта будзе <code>postgresql-9.1-903.jdbc4.jar</code>), і зьмяшчаем яго ў тэчку <code>/tmp</code>. Далей запускаем кансоль кіраваньня <i>WildFly</i>:</p>

<pre><code class="language-bash">
/opt/wildfly-8.2.0/bin $ bash jboss-cli.sh
</code></pre>

        <p>І пасьлядоўна наступныя каманды ў самой кансолі (для зручнасьці агляду тут устаўлены пераносы радку, але на самай справе рабіць іх ня трэба):</p>
        <img style="margin-top: 10px;" src="wildfly_postgres.jpg">
        <p>Юзэр <code>_USER_NAME_</code> з паролем <code>_PASSWORD_</code> і экзэмпляр базы <code>_DB_NAME_</code> ужо павінны быць створаныя ў лякальным <i>PostgreSQL</i>.</p>
      </section>

      <section>
        <h1 id="Docker">Docker</h1>
        <div class="refs">
          <ul>
            <li><a href="https://www.docker.com/">Home</a></li>
            <li><a href="https://docs.docker.com/">Docs</a></li>
            <li><a href="https://hub.docker.com/account/welcome/">Hub</a></li>
            <li><a href="https://cloud.docker.com/app/">Cloud</a></li>
          </ul>
        </div>
        <p><a href="http://merrigrove.blogspot.co.uk/2015/10/visualizing-docker-containers-and-images.html?_tmc=Diy2bNEQqG5t8sSbcMW6T5Us4KCmgsInjBviObh0atg&mkt_tok=3RkMMJWWfF9wsRonuqTMZKXonjHpfsX57u4lX6G2lMI%2F0ER3fOvrPUfGjI4AS8VqI%2BSLDwEYGJlv6SgFQ7LMMaZq1rgMXBk%3D">Visualizing Docker Containers and Images</a></p>
        <p><a href="http://blog.xebia.com/2015/08/31/making-amazon-ecs-container-service-as-easy-to-use-as-docker-run/?mkt_tok=3RkMMJWWfF9wsRonuqTMZKXonjHpfsX57u4lX6G2lMI%2F0ER3fOvrPUfGjI4ASMRhI%2BSLDwEYGJlv6SgFQ7LMMaZq1rgMXBk%3D">Making Amazon ECS Container Service As Easy To Use As Docker Run</a></p>
        <p><a href="http://tech.grammarly.com/blog/posts/Making-Docker-Rock-at-Grammarly.html?mkt_tok=3RkMMJWWfF9wsRonuqTMZKXonjHpfsX57u4lX6G2lMI%2F0ER3fOvrPUfGjI4ASMNhI%2BSLDwEYGJlv6SgFQ7LMMaZq1rgMXBk%3D">Making Docker Rock at Grammarly</a></p>
        <p><a href="https://www.shopify.com/technology/15934308-docker-at-shopify-how-we-built-containers-that-power-over-100-000-online-shops">Docker at Shopify: How we built containers that power over 100,000 online shops</a></p>
        <p><a href="https://www.shopify.com/technology/26892292-secrets-at-shopify-introducing-ejson">Secrets at Shopify - Introducing EJSON</a></p>
        <br />
        <p><a href="http://www.javacodegeeks.com/2015/09/best-practices-for-multi-tier-java-application-deployments-on-docker-containers-on-any-cloud.html">Best Practices for Multi-Tier Java Application Deployments on Docker Containers on Any Cloud</a></p>
        <p><a href="http://www.javacodegeeks.com/2015/10/docker-java-app-deployment-4-app-stacks-tomcat-glassfish-jetty-and-jboss.html">Docker Java App Deployment – 4 App Stacks: Tomcat, GlassFish, Jetty and JBoss</a></p>
        <p><a href="http://www.javacodegeeks.com/2015/12/step-step-guide-dockerizing-managing-java-app-28-different-application-stacks.html">A Step by Step Guide for Dockerizing and Managing a Java App on 28 Different Application Stacks</a></p>
        <p><a href="http://www.javacodegeeks.com/2015/11/10-awesome-docker-tutorials-to-kick-start-your-devops-projects.html">10 Awesome Docker Tutorials to Kick-Start your DevOps Projects</a></p>
        <br />
        <br />
        <br />
        <p><a href="https://docs.docker.com/engine/installation/linux/ubuntulinux/">Install Docker on Ubuntu</a>, <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04">How To Install and Use Docker on Ubuntu 16.04</a></p>
        <p><a href="https://docs.docker.com/engine/getstarted/step_one/">Install Docker and run hello-world</a></p>
        <p><a href="https://docs.docker.com/engine/admin/">Configuring and running Docker on various distributions</a></p>
        <p><a href="https://docs.docker.com/engine/reference/commandline/dockerd/">daemon</a></p>
        <p><a href="https://docs.docker.com/docker-cloud/installing-cli/">The Docker Cloud CLI</a></p>
        <p><a href="https://docs.docker.com/docker-cloud/infrastructure/byoh/">Use the Docker Cloud Agent</a></p>

        <h2 id="Docker_Install">Усталяваньне</h2>
        <div class="refs">
          <ul>
            <li><a href="https://docs.docker.com/engine/installation/linux/ubuntulinux/">How-To</a></li>
            <li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-16-04">How-To</a></li>
          </ul>
        </div>
        <p><i>Docker</i> патрабуе 64-бітнай вэрсіі <i>Ubuntu</i> (альбо яе клона), а таксама вэрсіі <i>kernel</i> не ніжэй за 3.10. Каб праверыць вэрсію <i>kernel</i>, скарыстайцеся камандай:</p>

<pre><code class="language-bash">
$ uname -r
4.4.0-21-generic
</code></pre>

        <p>Абнаўляем базу даных <i>apt-get</i> і ўсталёўваем неабходныя пакеты:</p>

<pre><code class="language-bash">
$ sudo apt-get update
$ sudo apt-get install apt-transport-https ca-certificates
</code></pre>

        <p>Дадаем у сыстэму <i>GPG</i>-ключ да афіцыйнага рэпазыторыю <i>Docker</i>:</p>

<pre><code class="language-bash">
$ sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
</code></pre>

        <p>Далей трэба дадаць рэпазыторый <i>Docker</i> да крыніц <i>apt-get</i>, дзе <code>&lt;REPO&gt;</code> трэба будзе замяніць спасылкай у адпаведнасьці з вэрсіяй ОС (глядзі ніжэй):</p>

<pre><code class="language-bash">
echo "deb &lt;REPO&gt; main" | sudo tee /etc/apt/sources.list.d/docker.list
</code></pre>

        <table>
          <thead>
            <tr>
              <th>Вэрсія Ubuntu</th>
              <th>Спасылка да крыніцы</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Precise 12.04 (LTS)</td>
              <td><code>https://apt.dockerproject.org/repo ubuntu-precise</code></td>
            </tr>
            <tr>
              <td>Trusty 14.04 (LTS)</td>
              <td><code>https://apt.dockerproject.org/repo ubuntu-trusty</code></td>
            </tr>
            <tr>
              <td>Xenial 16.04 (LTS)</td>
              <td><code>https://apt.dockerproject.org/repo ubuntu-xenial</code></td>
            </tr>
          </tbody>
        </table>

        <p>Ізноў абнаўляем базу даных <i>apt-get</i>:</p>

<pre><code class="language-bash">
$ sudo apt-get update
</code></pre>

        <p>Яшчэ раз пераконваемся, што зьбіраемся зрабіць ўсталёўку з рэпазыторыю <i>Docker</i>, а не <i>Ubuntu</i>:</p>

<pre><code class="language-bash">
$ apt-cache policy docker-engine
docker-engine:
  Installed: (none)
  Candidate: 1.12.2-0~xenial
  Version table:
 *** 1.12.2-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     1.12.1-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     1.12.0-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     1.11.2-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     1.11.1-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
     1.11.0-0~xenial 500
        500 https://apt.dockerproject.org/repo ubuntu-xenial/main amd64 Packages
</code></pre>

        <p>І напрыканцы ўсталёўваем <i>Docker</i>:</p>

<pre><code class="language-bash">
$ sudo apt-get install docker-engine
</code></pre>

        <p>У выніку павінен усталявацца <i>Docker</i>, запусьціцца сэрвіс, а таксама будзе прапісана каманда яго аўтастарту пры загрузцы сыстэмы. Каб пераканацца што сэрвіс запушчаны:</p>

<pre data-line="3"><code class="language-bash">
$ sudo systemctl status docker
● docker.service - Docker Application Container Engine
   Loaded: loaded (/lib/systemd/system/docker.service; enabled; vendor preset: enabled)
   Active: active (running) since Thu 2016-10-20 09:24:30 +03; 10h ago
     Docs: https://docs.docker.com
 Main PID: 1154 (dockerd)
</code></pre>


      </section>

      <section>
        <h1 id="EC2">EC2</h1>
        <div class="refs">
          <ul>
            <li><a href="http://aws.amazon.com/ec2/">Home</a></li>
            <li><a href="https://console.aws.amazon.com/ec2">Console</a></li>
          </ul>
        </div>
        <p>Перад тым, як стартаваць экзэмпляр сэрвэру, трэба стварыць пару ключоў:</p>
        <p><img src="createKeys.png" width="600px"></p>
        <p>Пры стварэньні пары ключоў сэрвіс Амазона запусьціць запампоўку публічнага ключа, яго трэба захаваць напрыклад у тэчку <code>~/.ec2/</code>  і потым спаслацца на яго пры стварэньні <i>ssh</i>-сэсіі. Пасьля гэтага цісьнем кнопку для старта сэрвэру:</p>
        <p><img src="launchInstance.png" width="600px"></p>
        <p>І выбіраем <i>Amazon Linux</i> са сьпісу магчымых перадвызначаных вобразаў:</p>
        <p><img src="amazonLinux.png" width="600px"></p>
        <p>Пры стварэньні <i>ssh</i>-сэсіі ў якасьці імені карыстальніка трэба ўвесьці <code>ec2-user</code>:</p>
        <p><img src="configureSsh.png" width="1000px"></p>
        
      </section>

      <section>
        <h1 id="CI">Continuous Integration</h1>
        <p>Усталёўка <i>Jenkins</i> на <i>Amazon Linux</i> праз <i>SSH</i>-кансоль:</p> 
        <ul>
          <li><a href="http://sanketdangi.com/post/62715793234/install-configure-jenkins-on-amazon-linux">http://sanketdangi.com/post/62715793234/install-configure-jenkins-on-amazon-linux</a></li>
          <li><a href="https://www.youtube.com/watch?v=1JSOGJQAhtE">https://www.youtube.com/watch?v=1JSOGJQAhtE</a></li>
        </ul>

        <h2 id="CI_Git">Git</h2>
        <p>Усталёўка <i>Git</i> на <i>Amazon Linux</i> праз <i>SSH</i>-кансоль: <code>sudo yum install git</code></p> 

        <h2 id="CI_JDK">JDK</h2>
        <p>Усталёўка <i>JDK</i> на <i>Amazon Linux</i> праз <i>SSH</i>-кансоль: <code>sudo yum install java-devel</code></p> 

        <h2 id="CI_Maven">Maven</h2>
        <p>Спачатку сьцягваем пакет усталёўкі:</p>

<pre><code class="language-bash">
$ wget https://repos.fedorapeople.org/repos/dchen/apache-maven/epel-7/x86_64/apache-maven-3.2.5-1.el7.noarch.rpm
</code></pre>

        <p>А потым запускаем саму ўсталёўку:</p> 

<pre><code class="language-bash">
$ rpm -ivh apache-maven-3.2.5-1.el7.noarch.rpm
</code></pre>
      </section>

      <footer>
        <div id="copyright">
          <p>Copyright &copy; 2010-2016 <a href="http://www.yurtsevich.info">yurtsevich.info</a></p>
          <p>
            <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/deed.be">
              <img src="http://i.creativecommons.org/l/by-nc/3.0/88x31.png"
                  style="border-style: none;" alt="Common Creatives. Attribution + Noncommercial (by-nc)" />
            </a>
          </p>
          <p><cite>Тэхнічны даведнік па разгортваньні праграм у працоўным асяродку</cite> публікуецца пад ліцэнзіяй <cite>Commons Creative Attribution-NonCommercial 3.0 Unported (CC BY-NC 3.0)</cite>. Вы вольны ў тым, як выкарыстоўваць гэтую працу, у тым ліку капіяваць, распаўсюджваць і зьмяняць яе на свой капыл. Але <strong>толькі ў некамэрцыйных мэтах</strong> і <strong>абавязкова з пазнакай <a href="http://yurtsevich.info/refs/deployRef/">крыніцы</a></strong> матэрыялу.</p>
        </div>
      </footer>


      <!-- Disqus BEGIN -->
        <div id="disqus_thread"></div>
        <script>
          (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');

          s.src = '//deploy-be.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
          })();
        </script>
        <noscript>Калі ласка, актывізуйце JavaScript каб бачыць <a href="http://disqus.com/?ref_noscript" rel="nofollow">камэнтары праз сыстэму Disqus.</a></noscript>
      <!-- Disqus END -->
    </article>
  </div> <!--! end of #container -->

  <div id="comments_link" class="uv-icon"><a href="#disqus_thread" title="Перайсьці да блёку з камэнтамі"></a></div>

  <!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
                                      Javascript at the bottom for fast page loading 
   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

  <!-- Grab Google CDN's jQuery. fall back to local if necessary -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="../js/libs/jquery-1.7.1.min.js"%3E%3C/script%3E'))</script>

  <!-- 3rd party library to display tree-like table of content -->
  <script src="../js/libs/jquery.tree.js"></script>
  <!-- Own script to build Refs index and article's table of content -->
  <script src="../js/index.js"></script>
  <!-- 3rd party library to fire scrolling events -->
  <script src="../js/libs/waypoints.min.js"></script>
  <!-- Own script to highlight currently viewing section in table of content with help of waypoints-library -->
  <script src="../js/ref.js"></script>
  <!-- 3rd party library to highlight code syntax -->
  <script src="../js/libs/prism.js"></script>

  <!-- To display embedded JSBin examples -->
  <script async src="http://static.jsbin.com/js/embed.min.js?3.35.2"></script>
  <!-- To display embedded CodePen examples -->
  <script async src="http://assets.codepen.io/assets/embed/ei.js"></script>

  <script src="../js/js.js"></script>

  <!-- Uservoice BEGIN -->
  <script>
    // Include the UserVoice JavaScript SDK (only needed once on a page)
    UserVoice=window.UserVoice||[];(function(){var uv=document.createElement('script');uv.type='text/javascript';uv.async=true;uv.src='//widget.uservoice.com/Of84cKdV6fJsdTM8rZd0g.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(uv,s)})();

    //
    // UserVoice Javascript SDK developer documentation:
    // https://www.uservoice.com/o/javascript-sdk
    //

    // Set colors
    UserVoice.push(['set', {
      accent_color: '#448dd6',
      trigger_color: 'white',
      trigger_background_color: 'rgba(46, 49, 51, 0.6)'
    }]);

    // Add default trigger to the bottom-right corner of the window:
    UserVoice.push(['addTrigger', { mode: 'contact', trigger_position: 'bottom-right' }]);

    // Or, use your own custom trigger:
    //UserVoice.push(['addTrigger', '#id', { mode: 'contact' }]);

    // Autoprompt for Satisfaction and SmartVote (only displayed under certain conditions)
    UserVoice.push(['autoprompt', {}]);
  </script>
  <!-- Uservoice END -->

  <!-- asynchronous google analytics: mathiasbynens.be/notes/async-analytics-snippet
       change the UA-XXXXX-X to be your site's ID -->
  <script>
   var _gaq = [['_setAccount', 'UA-18077954-1'], ['_trackPageview']];
   (function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = ('https:' == location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
   })(document, 'script');
  </script>

  <script src="http://static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">clicky.init(17136);</script>
</body>
</html>